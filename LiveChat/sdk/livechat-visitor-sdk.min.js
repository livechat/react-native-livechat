!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.LivechatVisitorSDK={})}(this,function(e){"use strict";var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e,t){return e(t={exports:{}},t.exports),t.exports}r(function(O){!function(e){var c,t=Object.prototype,s=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",n=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag",i=e.regeneratorRuntime;if(i)O.exports=i;else{(i=e.regeneratorRuntime=O.exports).wrap=y;var f="suspendedStart",p="suspendedYield",l="executing",d="completed",v={},u={};u[a]=function(){return this};var m=Object.getPrototypeOf,h=m&&m(m(P([])));h&&h!==t&&s.call(h,a)&&(u=h);var g=w.prototype=b.prototype=Object.create(u);_.prototype=g.constructor=w,w.constructor=_,w[o]=_.displayName="GeneratorFunction",i.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(g),e},i.awrap=function(e){return{__await:e}},I(k.prototype),k.prototype[n]=function(){return this},i.AsyncIterator=k,i.async=function(e,t,r,n){var a=new k(y(e,t,r,n));return i.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},I(g),g[o]="Generator",g[a]=function(){return this},g.toString=function(){return"[object Generator]"},i.keys=function(r){var n=[];for(var e in r)n.push(e);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},i.values=P,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(R),!e)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=c)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return o.type="throw",o.arg=r,n.next=e,t&&(n.method="next",n.arg=c),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var a=this.tryEntries[t],o=a.completion;if("root"===a.tryLoc)return e("end");if(a.tryLoc<=this.prev){var i=s.call(a,"catchLoc"),u=s.call(a,"finallyLoc");if(i&&u){if(this.prev<a.catchLoc)return e(a.catchLoc,!0);if(this.prev<a.finallyLoc)return e(a.finallyLoc)}else if(i){if(this.prev<a.catchLoc)return e(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return e(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}!a||"break"!==e&&"continue"!==e||t<a.tryLoc||a.finallyLoc<t||(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;R(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=c),v}}}function y(e,t,r,n){var o,i,u,c,a=Object.create((t&&t.prototype instanceof b?t:b).prototype),s=new T(n||[]);return a._invoke=(o=e,i=r,u=s,c=f,function(e,t){if(c===l)throw Error("Generator is already running");if(c===d){if("throw"===e)throw t;return S()}for(u.method=e,u.arg=t;;){var r=u.delegate;if(r){var n=A(r,u);if(n){if(n===v)continue;return n}}if("next"===u.method)u.sent=u._sent=u.arg;else if("throw"===u.method){if(c===f)throw c=d,u.arg;u.dispatchException(u.arg)}else"return"===u.method&&u.abrupt("return",u.arg);c=l;var a=x(o,i,u);if("normal"===a.type){if(c=u.done?d:p,a.arg===v)continue;return{value:a.arg,done:u.done}}"throw"===a.type&&(c=d,u.method="throw",u.arg=a.arg)}}),a}function x(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function b(){}function _(){}function w(){}function I(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function k(u){function c(e,t,r,n){var a=x(u[e],u,t);if("throw"!==a.type){var o=a.arg,i=o.value;return i&&"object"==typeof i&&s.call(i,"__await")?Promise.resolve(i.__await).then(function(e){c("next",e,r,n)},function(e){c("throw",e,r,n)}):Promise.resolve(i).then(function(e){o.value=e,r(o)},n)}n(a.arg)}var t;"object"==typeof e.process&&e.process.domain&&(c=e.process.domain.bind(c)),this._invoke=function(r,n){function e(){return new Promise(function(e,t){c(r,n,e,t)})}return t=t?t.then(e,e):e()}}function A(e,t){var r=e.iterator[t.method];if(r===c){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=c,A(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var n=x(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,v;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=c),t.delegate=null,v):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(s.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=c,e.done=!0,e};return n.next=n}}return{next:S}}function S(){return{value:c,done:!0}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:t)});var n,a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e){return"@@redux-saga/"+e},b=i("TASK"),u=i("HELPER"),_=i("MATCH"),w=i("CANCEL_PROMISE"),I=i("SAGA_ACTION"),G=i("SELF_CANCELLATION"),c=(n=!0,function(){return n}),B=function(){},p=function(e){return e};function k(e,t,r){if(!t(e))throw J("error","uncaught at check",r),Error(r)}var s=Object.prototype.hasOwnProperty;function f(e,t){return q.notUndef(e)&&s.call(e,t)}var q={undef:function(e){return null==e},notUndef:function(e){return null!=e},func:function(e){return"function"==typeof e},number:function(e){return"number"==typeof e},string:function(e){return"string"==typeof e},array:Array.isArray,object:function(e){return e&&!q.array(e)&&"object"===(void 0===e?"undefined":o(e))},promise:function(e){return e&&q.func(e.then)},iterator:function(e){return e&&q.func(e.next)&&q.func(e.throw)},iterable:function(e){return e&&q.func(Symbol)?q.func(e[Symbol.iterator]):q.array(e)},task:function(e){return e&&e[b]},observable:function(e){return e&&q.func(e.subscribe)},buffer:function(e){return e&&q.func(e.isEmpty)&&q.func(e.take)&&q.func(e.put)},pattern:function(e){return e&&(q.string(e)||"symbol"===(void 0===e?"undefined":o(e))||q.func(e)||q.array(e))},channel:function(e){return e&&q.func(e.take)&&q.func(e.close)},helper:function(e){return e&&e[u]},stringableFunc:function(e){return q.func(e)&&f(e,"toString")}},V={assign:function(e,t){for(var r in t)f(t,r)&&(e[r]=t[r])}};function z(e,t){var r=e.indexOf(t);r<0||e.splice(r,1)}var H={from:function(e){var t=Array(e.length);for(var r in e)f(e,r)&&(t[r]=e[r]);return t}};function K(){var r=a({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),e=new Promise(function(e,t){r.resolve=e,r.reject=t});return r.promise=e,r}function l(t){var r=arguments.length<=1||void 0===arguments[1]||arguments[1],n=void 0,e=new Promise(function(e){n=setTimeout(function(){return e(r)},t)});return e[w]=function(){return clearTimeout(n)},e}var Y=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return function(){return++e}}(),d=function(e){throw e},v=function(e){return{value:e,done:!0}};function $(e){var t={name:2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",next:e,throw:1<arguments.length&&void 0!==arguments[1]?arguments[1]:d,return:v};return arguments[3]&&(t[u]=!0),"undefined"!=typeof Symbol&&(t[Symbol.iterator]=function(){return t}),t}function J(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";"undefined"==typeof window?console.log("redux-saga "+e+": "+t+"\n"+(r&&r.stack||r)):console[e](t,r)}function Q(e,t){return function(){return e.apply(void 0,arguments)}}var Z=function(e,t){return e+" has been deprecated in favor of "+t+", please update your code"},m=function(e){return Error("\n  redux-saga: Error checking hooks detected an inconsistent state. This is likely a bug\n  in redux-saga code and not yours. Thanks for reporting this in the project's github repo.\n  Error: "+e+"\n")},X=function(e,t){return(e?e+".":"")+"setContext(props): argument "+t+" is not a plain object"},h=function(t){return function(e){return t(Object.defineProperty(e,I,{value:!0}))}},g={done:!0,value:void 0},y={};var x={isEmpty:c,put:B,take:B};function A(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10,n=arguments[1],a=Array(r),o=0,i=0,u=0,c=function(e){a[i]=e,i=(i+1)%r,o++},t=function(){if(0!=o){var e=a[u];return a[u]=null,o--,u=(u+1)%r,e}},s=function(){for(var e=[];o;)e.push(t());return e};return{isEmpty:function(){return 0==o},put:function(e){if(o<r)c(e);else{var t=void 0;switch(n){case 1:throw Error("Channel's Buffer overflow!");case 3:a[i]=e,u=i=(i+1)%r;break;case 4:t=2*r,a=s(),i=o=a.length,u=0,r=a.length=t,c(e)}}},take:t,flush:s}}var ee={none:function(){return x},fixed:function(e){return A(e,1)},dropping:function(e){return A(e,2)},sliding:function(e){return A(e,3)},expanding:function(e){return A(e,4)}},E=[],R=0;function T(e){try{re(),e()}finally{P()}}function te(e){E.push(e),R||(re(),ne())}function re(){R++}function P(){R--}function ne(){P();for(var e=void 0;!R&&void 0!==(e=E.shift());)T(e)}var ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S="@@redux-saga/CHANNEL_END",O={type:S},oe=function(e){return e&&e.type===S};var C="invalid buffer passed to channel factory function",j="Saga was provided with an undefined action";function ie(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ee.none(),r=arguments[2];2<arguments.length&&k(r,q.func,"Invalid match function passed to eventChannel");var n=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:ee.fixed(),a=!1,o=[];function i(){if(a&&o.length)throw m("Cannot have a closed channel with pending takers");if(o.length&&!n.isEmpty())throw m("Cannot have pending takers with non empty buffer")}return k(n,q.buffer,C),{take:function(e){i(),k(e,q.func,"channel.take's callback must be a function"),a&&n.isEmpty()?e(O):n.isEmpty()?(o.push(e),e.cancel=function(){return z(o,e)}):e(n.take())},put:function(e){if(i(),k(e,q.notUndef,j),!a){if(!o.length)return n.put(e);for(var t=0;t<o.length;t++){var r=o[t];if(!r[_]||r[_](e))return o.splice(t,1),r(e)}}},flush:function(e){i(),k(e,q.func,"channel.flush' callback must be a function"),a&&n.isEmpty()?e(O):e(n.flush())},close:function(){if(i(),!a&&(a=!0,o.length)){var e=o;o=[];for(var t=0,r=e.length;t<r;t++)e[t](O)}},get __takers__(){return o},get __closed__(){return a}}}(t),a=function(){n.__closed__||(o&&o(),n.close())},o=e(function(e){oe(e)?a():r&&!r(e)||n.put(e)});if(n.__closed__&&o(),!q.func(o))throw Error("in eventChannel: subscribe should return a function to unsubscribe");return{take:n.take,flush:n.flush,close:a}}function N(e,t){for(var r=arguments.length,n=Array(2<r?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var o,i={done:!1,value:me(e)},u=void 0,c=function(e){return u=e};return function(n,e){var a=void 0,o=e;function t(e,t){if(o===y)return g;if(t)throw o=y,t;a&&a(e);var r=n[o]();return a=r[2],(o=r[0])===y?g:r[1]}return $(t,function(e){return t(null,e)},2<arguments.length&&void 0!==arguments[2]?arguments[2]:"iterator",!0)}({q1:function(){return["q2",i,c]},q2:function(){return u===O?[y]:["q1",(e=u,{done:!1,value:_e.apply(void 0,[t].concat(n,[e]))})];var e}},"q1","takeEvery("+(q.channel(o=e)?"channel":Array.isArray(o)?o.map(function(e){return e+""})+"":o+"")+", "+t.name+")")}var M=i("IO"),L="TAKE",D="PUT",F="ALL",U="RACE",W="CALL",ue="FORK",ce="JOIN",se="CANCEL",fe="SELECT",pe="ACTION_CHANNEL",le="GET_CONTEXT",de="\n(HINT: if you are getting this errors in tests, consider using createMockTask from redux-saga/utils)",ve=function(e,t){var r;return(r={})[M]=!0,r[e]=t,r};function me(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"*";if(arguments.length&&k(arguments[0],q.notUndef,"take(patternOrChannel): patternOrChannel is undefined"),q.pattern(e))return ve(L,{pattern:e});if(q.channel(e))return ve(L,{channel:e});throw Error("take(patternOrChannel): argument "+e+" is not valid channel or a valid pattern")}function he(e,t){return 1<arguments.length?(k(e,q.notUndef,"put(channel, action): argument channel is undefined"),k(e,q.channel,"put(channel, action): argument "+e+" is not a valid channel"),k(t,q.notUndef,"put(channel, action): argument action is undefined")):(k(e,q.notUndef,"put(action): argument action is undefined"),t=e,e=null),ve(D,{channel:e,action:t})}function ge(e){return ve(F,e)}function ye(e){return ve(U,e)}function xe(e,t,r){k(t,q.notUndef,e+": argument fn is undefined");var n=null;if(q.array(t)){n=t[0],t=t[1]}else if(t.fn){n=t.context,t=t.fn}return n&&q.string(t)&&q.func(n[t])&&(t=n[t]),k(t,q.func,e+": argument "+t+" is not a function"),{context:n,fn:t,args:r}}function be(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return ve(W,xe("call",e,r))}function _e(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return ve(ue,xe("fork",e,r))}function we(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=_e.apply(void 0,[e].concat(r));return a[ue].detached=!0,a}function Ie(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(1<t.length)return ge(t.map(function(e){return Ie(e)}));var n=t[0];return k(n,q.notUndef,"join(task): argument task is undefined"),k(n,q.task,"join(task): argument "+n+" is not a valid Task object "+de),ve(ce,n)}function ke(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(1<t.length)return ge(t.map(function(e){return ke(e)}));var n=t[0];return 1===t.length&&(k(n,q.notUndef,"cancel(task): argument task is undefined"),k(n,q.task,"cancel(task): argument "+n+" is not a valid Task object "+de)),ve(se,n||G)}function Ae(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return 0===arguments.length?e=p:(k(e,q.notUndef,"select(selector,[...]): argument selector is undefined"),k(e,q.func,"select(selector,[...]): argument "+e+" is not a function")),ve(fe,{selector:e,args:r})}function Ee(e,t){return k(e,q.notUndef,"actionChannel(pattern,...): argument pattern is undefined"),1<arguments.length&&(k(t,q.notUndef,"actionChannel(pattern, buffer): argument buffer is undefined"),k(t,q.buffer,"actionChannel(pattern, buffer): argument "+t+" is not a valid buffer")),ve(pe,{pattern:e,buffer:t})}function Re(e){return k(e,q.string,"getContext(prop): argument "+e+" is not a string"),ve(le,e)}function Te(e,t){for(var r=arguments.length,n=Array(2<r?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];return _e.apply(void 0,[N,e,t].concat(n))}me.maybe=function(){var e=me.apply(void 0,arguments);return e[L].maybe=!0,e},he.sync=Q(he.resolve=function(){var e=he.apply(void 0,arguments);return e[D].resolve=!0,e},Z("put.sync","put.resolve"));var Pe=function(t){return function(e){return e&&e[M]&&e[t]}},Se={take:Pe(L),put:Pe(D),all:Pe(F),race:Pe(U),call:Pe(W),cps:Pe("CPS"),fork:Pe(ue),join:Pe(ce),cancel:Pe(se),select:Pe(fe),actionChannel:Pe(pe),cancelled:Pe("CANCELLED"),flush:Pe("FLUSH"),getContext:Pe(le),setContext:Pe("SET_CONTEXT")},Oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var je="proc first argument (Saga function result) must be an iterator",Ne={toString:function(){return"@@redux-saga/CHANNEL_END"}},Me={toString:function(){return"@@redux-saga/TASK_CANCEL"}},Le={wildcard:function(){return c},default:function(t){return"symbol"===(void 0===t?"undefined":Ce(t))?function(e){return e.type===t}:function(e){return e.type===t+""}},array:function(e){return function(t){return e.some(function(e){return De(e)(t)})}},predicate:function(t){return function(e){return t(e)}}};function De(e){return("*"===e?Le.wildcard:q.array(e)?Le.array:q.stringableFunc(e)?Le.default:q.func(e)?Le.predicate:Le.default)(e)}var Fe=function(e){return{fn:e}};function Ue(n){var A=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){return B},E=2<arguments.length&&void 0!==arguments[2]?arguments[2]:B,R=3<arguments.length&&void 0!==arguments[3]?arguments[3]:B,e=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{},u=5<arguments.length&&void 0!==arguments[5]?arguments[5]:{},a=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,T=7<arguments.length&&void 0!==arguments[7]?arguments[7]:"anonymous",t=arguments[8];k(n,q.iterator,je);var r,o,i="[...effects]",P=Q(W,Z(i,"all("+i+")")),S=u.sagaMonitor,c=u.onError,O=u.logger||J,C=(r=A,o=ie(function(t){return r(function(e){e[I]?t(e):te(function(){return t(e)})})}),ae({},o,{take:function(e,t){1<arguments.length&&(k(t,q.func,"channel.take's matcher argument must be a function"),e[_]=t),o.take(e)}})),j=Object.create(e);y.cancel=B;var s,f,p,l,d,v,m,N=(s=a,f=T,l=t,(v={})[b]=!((p=n)._deferredEnd=null),v.id=s,v.name=f,(m={})[d="done"]=m[d]||{},m[d].get=function(){if(p._deferredEnd)return p._deferredEnd.promise;var e=K();return p._deferredEnd=e,p._isRunning||(p._error?e.reject(p._error):e.resolve(p._result)),e.promise},v.cont=l,v.joiners=[],v.cancel=g,v.isRunning=function(){return p._isRunning},v.isCancelled=function(){return p._isCancelled},v.isAborted=function(){return p._isAborted},v.result=function(){return p._result},v.error=function(){return p._error},v.setContext=function(e){k(e,q.object,X("task",e)),V.assign(j,e)},function(e,t){for(var r in t){var n=t[r];n.configurable=n.enumerable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r,n)}}(v,m),v),M={name:T,cancel:function(){M.isRunning&&!M.isCancelled&&(M.isCancelled=!0,y(Me))},isRunning:!0},h=function(e,n,a){var o=[],i=void 0,u=!1;function c(e){r(),a(e,!0)}function t(r){o.push(r),r.cont=function(e,t){u||(z(o,r),r.cont=B,t?c(e):(r===n&&(i=e),o.length||(u=!0,a(i))))}}function r(){u||(u=!0,o.forEach(function(e){e.cont=B,e.cancel()}),o=[])}return t(n),{addTask:t,cancelAll:r,abort:c,getTasks:function(){return o},taskNames:function(){return o.map(function(e){return e.name})}}}(0,M,x);function g(){n._isRunning&&!n._isCancelled&&(n._isCancelled=!0,h.cancelAll(),x(Me))}return t&&(t.cancel=g),n._isRunning=!0,y(),N;function y(e,t){if(!M.isRunning)throw Error("Trying to resume an already finished generator");try{var r=void 0;t?r=n.throw(e):e===Me?(M.isCancelled=!0,y.cancel(),r=q.func(n.return)?n.return(Me):{done:!0,value:Me}):r=e===Ne?q.func(n.return)?n.return():{done:!0}:n.next(e),r.done?(M.isMainRunning=!1,M.cont&&M.cont(r.value)):L(r.value,a,"",y)}catch(e){M.isCancelled&&O("error","uncaught at "+T,e.message),M.isMainRunning=!1,M.cont(e,!0)}}function x(t,r){n._isRunning=!1,C.close(),r?(t instanceof Error&&(t.sagaStack="at "+T+" \n "+(t.sagaStack||t.stack)),N.cont||(O("error","uncaught",t.sagaStack||t.stack),t instanceof Error&&c&&c(t)),n._error=t,n._isAborted=!0,n._deferredEnd&&n._deferredEnd.reject(t)):(n._result=t,n._deferredEnd&&n._deferredEnd.resolve(t)),N.cont&&N.cont(t,r),N.joiners.forEach(function(e){return e.cb(t,r)}),N.joiners=null}function L(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=arguments[3],a=Y();S&&S.effectTriggered({effectId:a,parentEffectId:t,label:r,effect:e});var o=void 0;function i(e,t){o||(o=!0,n.cancel=B,S&&(t?S.effectRejected(a,e):S.effectResolved(a,e)),n(e,t))}i.cancel=B,n.cancel=function(){if(!o){o=!0;try{i.cancel()}catch(e){O("error","uncaught at "+T,e.message)}i.cancel=B,S&&S.effectCancelled(a)}};var u,c,s,f,p,l,d,v,m,h,g,y,x,b,_,w,I,k=void 0;return q.promise(e)?D(e,i):q.helper(e)?U(Fe(e),a,i):q.iterator(e)?F(e,a,T,i):q.array(e)?P(e,a,i):(k=Se.take(e))?function(e,t){var r=e.channel,n=e.pattern,a=e.maybe;r=r||C;var o=function(e){return e instanceof Error?t(e,!0):oe(e)&&!a?t(Ne):t(e)};try{r.take(o,De(n))}catch(e){return t(e,!0)}t.cancel=o.cancel}(k,i):(k=Se.put(e))?(b=i,_=(x=k).channel,w=x.action,I=x.resolve,void te(function(){var e=void 0;try{e=(_?_.put:E)(w)}catch(e){if(_||I)return b(e,!0);O("error","uncaught at "+T,e.stack||e.message||e)}if(!I||!q.promise(e))return b(e);D(e,b)})):(k=Se.all(e))?W(k,a,i):(k=Se.race(e))?(v=a,m=i,h=void 0,y={},(g=Object.keys(d=k)).forEach(function(n){var e=function(e,t){if(!h)if(t)m.cancel(),m(e,!0);else if(!oe(e)&&e!==Ne&&e!==Me){var r;m.cancel(),h=!0,m(((r={})[n]=e,r))}};e.cancel=B,y[n]=e}),m.cancel=function(){h||(h=!0,g.forEach(function(e){return y[e].cancel()}))},void g.forEach(function(e){h||L(d[e],v,e,y[e])})):(k=Se.call(e))?function(e,t,r){var n=e.context,a=e.fn,o=e.args,i=void 0;try{i=a.apply(n,o)}catch(e){return r(e,!0)}return q.promise(i)?D(i,r):q.iterator(i)?F(i,t,a.name,r):r(i)}(k,a,i):(k=Se.cps(e))?function(e,r){var t=e.context,n=e.fn,a=e.args;try{var o=function(e,t){return q.undef(e)?r(t):r(e,!0)};n.apply(t,a.concat(o)),o.cancel&&(r.cancel=function(){return o.cancel()})}catch(e){return r(e,!0)}}(k,i):(k=Se.fork(e))?U(k,a,i):(k=Se.join(e))?function(e,t){if(e.isRunning()){var r={task:N,cb:t};t.cancel=function(){return z(e.joiners,r)},e.joiners.push(r)}else e.isAborted()?t(e.error(),!0):t(e.result())}(k,i):(k=Se.cancel(e))?function(e,t){e===G&&(e=N);e.isRunning()&&e.cancel();t()}(k,i):(k=Se.select(e))?function(e,t){var r=e.selector,n=e.args;try{var a=r.apply(void 0,[R()].concat(n));t(a)}catch(e){t(e,!0)}}(k,i):(k=Se.actionChannel(e))?(s=i,p=(c=k).buffer,(l=De(f=c.pattern)).pattern=f,void s(ie(A,p||ee.fixed(),l))):(k=Se.flush(e))?void k.flush(i):(k=Se.cancelled(e))?void i(!!M.isCancelled):(k=Se.getContext(e))?void i(j[k]):(k=Se.setContext(e))?(u=i,V.assign(j,k),void u()):i(e)}function D(e,t){var r=e[w];q.func(r)?t.cancel=r:q.func(e.abort)&&(t.cancel=function(){return e.abort()}),e.then(t,function(e){return t(e,!0)})}function F(e,t,r,n){Ue(e,A,E,R,j,u,t,r,n)}function U(e,t,r){var n=e.fn,a=e.detached,o=function(e){var t=e.context,r=e.fn,n=e.args;if(q.iterator(r))return r;var a,o,i=void 0,u=void 0;try{i=r.apply(t,n)}catch(e){u=e}return q.iterator(i)?i:$(u?function(){throw u}:(a=void 0,o={done:!1,value:i},function(e){return a?{done:!0,value:e}:(a=!0,o)}))}({context:e.context,fn:n,args:e.args});try{re();var i=Ue(o,A,E,R,j,u,t,n.name,a?null:B);a?r(i):o._isRunning?(h.addTask(i),r(i)):o._error?h.abort(o._error):r(i)}finally{ne()}}function W(n,t,a){var o=Object.keys(n);if(!o.length)return a(q.array(n)?[]:{});var i=0,u=void 0,c={},s={};o.forEach(function(r){var e=function(e,t){u||(t||oe(e)||e===Ne||e===Me?(a.cancel(),a(e,t)):(c[r]=e,++i===o.length&&(u=!0,a(q.array(n)?H.from(Oe({},c,{length:o.length})):c))))};e.cancel=B,s[r]=e}),a.cancel=function(){u||(u=!0,o.forEach(function(e){return s[e].cancel()}))},o.forEach(function(e){return L(n[e],t,e,s[e])})}}var We="object"==typeof global&&global&&global.Object===Object&&global,Ge="object"==typeof self&&self&&self.Object===Object&&self,Be=(We||Ge||Function("return this")()).Symbol,qe=Object.prototype,Ve=qe.hasOwnProperty,ze=qe.toString,He=Be?Be.toStringTag:void 0;var Ke=Object.prototype.toString;var Ye="[object Null]",$e="[object Undefined]",Je=Be?Be.toStringTag:void 0;function Qe(e){return null==e?void 0===e?$e:Ye:Je&&Je in Object(e)?function(e){var t=Ve.call(e,He),r=e[He];try{var n=!(e[He]=void 0)}catch(e){}var a=ze.call(e);return n&&(t?e[He]=r:delete e[He]),a}(e):Ke.call(e)}var Ze,Xe,et=(Ze=Object.getPrototypeOf,Xe=Object,function(e){return Ze(Xe(e))});var tt,rt="[object Object]",nt=Function.prototype.toString,at=Object.prototype.hasOwnProperty,ot=nt.call(Object);tt="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")();var it,ut,ct=("function"==typeof(ut=tt.Symbol)?ut.observable?it=ut.observable:(it=ut("observable"),ut.observable=it):it="@@observable",it),st={INIT:"@@redux/INIT"};function ft(e,t,r){var n;if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw Error("Expected the enhancer to be a function.");return r(ft)(e,t)}if("function"!=typeof e)throw Error("Expected the reducer to be a function.");var a=e,o=t,i=[],u=i,c=!1;function s(){u===i&&(u=i.slice())}function f(){return o}function p(t){if("function"!=typeof t)throw Error("Expected listener to be a function.");var r=!0;return s(),u.push(t),function(){if(r){r=!1,s();var e=u.indexOf(t);u.splice(e,1)}}}function l(e){if(!function(e){if(null==(t=e)||"object"!=typeof t||Qe(e)!=rt)return!1;var t,r=et(e);if(null===r)return!0;var n=at.call(r,"constructor")&&r.constructor;return"function"==typeof n&&n instanceof n&&nt.call(n)==ot}(e))throw Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw Error("Reducers may not dispatch actions.");try{c=!0,o=a(o,e)}finally{c=!1}for(var t=i=u,r=0;r<t.length;r++){(0,t[r])()}return e}return l({type:st.INIT}),(n={dispatch:l,subscribe:p,getState:f,replaceReducer:function(e){if("function"!=typeof e)throw Error("Expected the nextReducer to be a function.");a=e,l({type:st.INIT})}})[ct]=function(){var e,r=p;return(e={subscribe:function(e){if("object"!=typeof e)throw new TypeError("Expected the observer to be an object.");function t(){e.next&&e.next(f())}return t(),{unsubscribe:r(t)}}})[ct]=function(){return this},e},n}function pt(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}var lt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};var dt,vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt=(dt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,function(e,t,r,n){var a=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={}),t&&a)for(var i in a)void 0===t[i]&&(t[i]=a[i]);else t||(t=a||{});if(1===o)t.children=n;else if(1<o){for(var u=Array(o),c=0;c<o;c++)u[c]=arguments[c+3];t.children=u}return{$$typeof:dt,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}),ht=function(){function s(e){this.value=e}function t(a){var o,i;function u(e,t){try{var r=a[e](t),n=r.value;n instanceof s?Promise.resolve(n.value).then(function(e){u("next",e)},function(e){u("throw",e)}):c(r.done?"return":"normal",r.value)}catch(e){c("throw",e)}}function c(e,t){switch(e){case"return":o.resolve({value:t,done:!0});break;case"throw":o.reject(t);break;default:o.resolve({value:t,done:!1})}(o=o.next)?u(o.key,o.arg):i=null}this._invoke=function(n,a){return new Promise(function(e,t){var r={key:n,arg:a,resolve:e,reject:t,next:null};i?i=i.next=r:(o=i=r,u(n,a))})},"function"!=typeof a.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(e){return new s(e)}}}(),gt=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),yt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xt=function(e,t){var r={};for(var n in e)t.indexOf(n)<0&&Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},bt="undefined"==typeof global?self:global,_t=Object.freeze({jsx:mt,asyncIterator:function(e){if("function"==typeof Symbol){if(Symbol.asyncIterator){var t=e[Symbol.asyncIterator];if(null!=t)return t.call(e)}if(Symbol.iterator)return e[Symbol.iterator]()}throw new TypeError("Object is not async iterable")},asyncGenerator:ht,asyncGeneratorDelegate:function(n,e){var t={},a=!1;function r(t,r){return a=!0,r=new Promise(function(e){e(n[t](r))}),{done:!1,value:e(r)}}return"function"==typeof Symbol&&Symbol.iterator&&(t[Symbol.iterator]=function(){return this}),t.next=function(e){return a?(a=!1,e):r("next",e)},"function"==typeof n.throw&&(t.throw=function(e){if(a)throw a=!1,e;return r("throw",e)}),"function"==typeof n.return&&(t.return=function(e){return r("return",e)}),t},asyncToGenerator:function(e){return function(){var u=e.apply(this,arguments);return new Promise(function(o,i){return function t(e,r){try{var n=u[e](r),a=n.value}catch(e){return void i(e)}if(!n.done)return Promise.resolve(a).then(function(e){t("next",e)},function(e){t("throw",e)});o(a)}("next")})}},classCallCheck:function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},createClass:gt,defineEnumerableProperties:function(e,t){for(var r in t){var n=t[r];n.configurable=n.enumerable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r,n)}return e},defaults:function(e,t){for(var r=Object.getOwnPropertyNames(t),n=0;n<r.length;n++){var a=r[n],o=Object.getOwnPropertyDescriptor(t,a);o&&o.configurable&&void 0===e[a]&&Object.defineProperty(e,a,o)}return e},defineProperty:function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},get:function e(t,r,n){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,r);if(void 0===a){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in a)return a.value;var i=a.get;return void 0!==i?i.call(n):void 0},inherits:function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},interopRequireDefault:function(e){return e&&e.__esModule?e:{default:e}},interopRequireWildcard:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},newArrowCheck:function(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")},objectDestructuringEmpty:function(e){if(null==e)throw new TypeError("Cannot destructure undefined")},objectWithoutProperties:xt,possibleConstructorReturn:function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},selfGlobal:bt,set:function e(t,r,n,a){var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);null!==i&&e(i,r,n,a)}else if("value"in o&&o.writable)o.value=n;else{var u=o.set;void 0!==u&&u.call(a,n)}return n},slicedToArray:function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},slicedToArrayLoose:function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){for(var r,n=[],a=e[Symbol.iterator]();!(r=a.next()).done&&(n.push(r.value),!t||n.length!==t););return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")},taggedTemplateLiteral:function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},taggedTemplateLiteralLoose:function(e,t){return e.raw=t,e},temporalRef:function(e,t,r){if(e===r)throw new ReferenceError(t+" is not defined - temporal dead zone");return e},temporalUndefined:{},toArray:function(e){return Array.isArray(e)?e:Array.from(e)},toConsumableArray:function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},typeof:vt,extends:yt,instanceof:function(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?t[Symbol.hasInstance](e):e instanceof t}}),wt={}.hasOwnProperty;function It(e,t){return wt.call(t,e)}var kt=Array.isArray,At="function"==typeof Symbol&&"symbol"===vt(Symbol.iterator)?function(e){return void 0===e?"undefined":vt(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":vt(e)};function Et(r,n){return Object.keys(n).reduce(function(e,t){return e[t]=r(n[t]),e},{})}function Rt(e){return e.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(e,t){return t.toUpperCase()})}function Tt(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(e(n))return n}}function Pt(t,r){return Object.keys(r).forEach(function(e){t(r[e],e)})}function St(e){var t=Math.random().toString(36).substring(2);return It(t,e)?St(e):t}function Ot(e,t){for(var r="string"==typeof e?e.split("."):e,n=0,a=t;a&&n<r.length;)a=a[r[n++]];return a}function Ct(e,t,r){var n=Ot(t,r);return null!=n?n:e}function jt(r,n){return Object.keys(n).reduce(function(e,t){return e[r(t)]=n[t],e},{})}function Nt(r,e){return n=function(e,t){return-1!==r.indexOf(t)},Object.keys(a=e).reduce(function(e,t){return n(a[t],t)||(e[t]=a[t]),e},{});var n,a}"function"==typeof Symbol&&vt(Symbol.iterator);var Mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lt=function(r,n){var e=function e(){var t=n.apply(void 0,arguments);return"function"==typeof t?e:{type:r,payload:t}};return e.getActionName=function(){return r},e.toString=function(){return r},e},Dt=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Ft=function(e){var t;return(t={})["setProperty"+Dt(e)]=Lt("SET_PROPERTY_"+e.toUpperCase(),function(e){return{data:e}}),t["removeProperty"+Dt(e)]=Lt("REMOVE_PROPERTY_"+e.toUpperCase(),function(){return{propName:e}}),t},Ut={LICENSE:"license",GROUP:"group",SESSION_ID:"sessionId",SECURED_TOKEN:"securedToken",CHAT_ID:"chatId",CHAT_STATE:"chatState",CHAT_STATUS:"chatStatus",VISITOR_ID:"visitorId",CUSTOM_VISITOR_ID:"customVisitorId",LAST_MESSAGE_ID:"lastMessageId",CONNECTION_STATUS:"connectionStatus",SNEAK_PEEK:"sneakPeek",TICKET_FORM:"ticketForm",PRE_CHAT_FORM:"preChatForm",POST_CHAT_FORM:"postChatForm",STATIC_CONFIG_VERSION:"staticConfigVersion",TRANSLATIONS_VERSION:"translationsVersion",TRANSLATIONS:"translations",SECRET_ID:"secretId",REGION:"region",CONFIG_LOADED:"configLoaded",LAST_AGENT_ID:"lastAgentId",DYNAMIC_CONFIG:"dynamicConfig",CONFIG:"config",WELCOME_MESSAGE:"welcomeMessage",ACCEPTED_INVITATION:"acceptedInvitation",SERVER_IDS_MAP:"serverIdsMap",VISITOR_CUSTOM_ID_MAP:"visitorCustomIdMap",CLIENT_LIMIT_EXCEEDED:"clientLimitExceeded",PING_SENT:"pingSent",CHAT_BETWEEN_GROUPS:"chatBetweenGroups",HISTORY_LOADED:"historyLoaded"},Wt=yt({},Ft(Ut.LICENSE),Ft(Ut.GROUP),Ft(Ut.SESSION_ID),Ft(Ut.SECURED_TOKEN),Ft(Ut.CHAT_ID),Ft(Ut.CHAT_STATE),Ft(Ut.VISITOR_ID),Ft(Ut.CUSTOM_VISITOR_ID),Ft(Ut.LAST_MESSAGE_ID),Ft(Ut.CHAT_STATUS),Ft(Ut.CONNECTION_STATUS),Ft(Ut.SNEAK_PEEK),Ft(Ut.TICKET_FORM),Ft(Ut.STATIC_CONFIG_VERSION),Ft(Ut.SECRET_ID),Ft(Ut.REGION),Ft(Ut.CONFIG_LOADED),Ft(Ut.LAST_AGENT_ID),Ft(Ut.PRE_CHAT_FORM),Ft(Ut.TRANSLATIONS_VERSION),Ft(Ut.TRANSLATIONS),Ft(Ut.POST_CHAT_FORM),Ft(Ut.CONFIG),Ft(Ut.DYNAMIC_CONFIG),Ft(Ut.WELCOME_MESSAGE),Ft(Ut.ACCEPTED_INVITATION),Ft(Ut.SERVER_IDS_MAP),Ft(Ut.VISITOR_CUSTOM_ID_MAP),Ft(Ut.CLIENT_LIMIT_EXCEEDED),Ft(Ut.PING_SENT),Ft(Ut.CHAT_BETWEEN_GROUPS),Ft(Ut.HISTORY_LOADED)),Gt=Lt("CHAT_STARTED",function(e){return{securedToken:e.securedToken,welcomeMessage:e.welcomeMessage,visitorMessage:e.visitorMessage}}),Bt=Lt("NEW_MESSAGE",function(e){return{id:e.id,timestamp:e.timestamp,authorType:e.authorType,authorId:e.authorId,text:e.text,chatId:e.chatId,isMobile:e.isMobile,customId:e.customId,serverId:e.serverId}}),qt=Lt("CHAT_ENDED",function(){return null}),Vt=Lt("NEW_AGENT",function(e){return{avatarUrl:e.avatarUrl,jobTitle:e.jobTitle,name:e.name,id:e.id}}),zt=Lt("VISITOR_DATA_SET",function(e){return{visitorData:e.visitorData,requestId:e.requestId}}),Ht=Lt("VISITOR_DATA_SET_ERROR",function(e){return{error:e.error,requestId:e.requestId}}),Kt=Lt("NEW_FILE",function(e){return{id:e.id,timestamp:e.timestamp,authorType:e.authorType,authorId:e.authorId,url:e.url,size:e.size,contentType:e.contentType,attachmentToken:e.attachmentToken,thumbnail:e.thumbnail}}),Yt=Lt("VISITOR_QUEUED",function(e){return{numberInQueue:e.numberInQueue,waitingTime:e.waitingTime}}),$t=Lt("TYPING_INDICATOR",function(e){return{authorId:e.authorId,isTyping:e.isTyping}}),Jt=Lt("RATE_CHAT",function(e){return{rate:e.rate,comment:e.comment}}),Qt=Lt("SET_VISITOR_DATA",function(e){return{visitorData:e.visitorData,requestId:e.requestId}}),Zt=Lt("SEND_FILE",function(e){return{file:e.file,customId:e.customId}}),Xt=Lt("REQUEST_FILE_TOKEN",function(e){return{customId:e.customId}}),er=Lt("FILE_TOKEN_RECEIVED",function(e){return{customId:e.customId,token:e.token}}),tr=Lt("NEW_INVITATION",function(e){return{id:e.id,authorId:e.authorId,text:e.text,receivedFirstTime:e.receivedFirstTime}}),rr=Lt("MESSAGE_SEEN",function(e){return{id:e.id,customId:e.customId,type:e.type}}),nr=Lt("PROTOCOL_UPGRADED",function(){}),ar=Object.freeze({chatStarted:Gt,newMessage:Bt,chatEnded:qt,newAgent:Vt,visitorDataSet:zt,visitorDataSetError:Ht,newFile:Kt,visitorQueued:Yt,typingIndicator:$t,rateChat:Jt,setVisitorData:Qt,sendFile:Zt,requestFileToken:Xt,fileTokenReceived:er,newInvitation:tr,messageSeen:rr,protocolUpgraded:nr}),or=r(function(e,o){o.aliasToReal={each:"forEach",eachRight:"forEachRight",entries:"toPairs",entriesIn:"toPairsIn",extend:"assignIn",extendAll:"assignInAll",extendAllWith:"assignInAllWith",extendWith:"assignInWith",first:"head",conforms:"conformsTo",matches:"isMatch",property:"get",__:"placeholder",F:"stubFalse",T:"stubTrue",all:"every",allPass:"overEvery",always:"constant",any:"some",anyPass:"overSome",apply:"spread",assoc:"set",assocPath:"set",complement:"negate",compose:"flowRight",contains:"includes",dissoc:"unset",dissocPath:"unset",dropLast:"dropRight",dropLastWhile:"dropRightWhile",equals:"isEqual",identical:"eq",indexBy:"keyBy",init:"initial",invertObj:"invert",juxt:"over",omitAll:"omit",nAry:"ary",path:"get",pathEq:"matchesProperty",pathOr:"getOr",paths:"at",pickAll:"pick",pipe:"flow",pluck:"map",prop:"get",propEq:"matchesProperty",propOr:"getOr",props:"at",symmetricDifference:"xor",symmetricDifferenceBy:"xorBy",symmetricDifferenceWith:"xorWith",takeLast:"takeRight",takeLastWhile:"takeRightWhile",unapply:"rest",unnest:"flatten",useWith:"overArgs",where:"conformsTo",whereEq:"isMatch",zipObj:"zipObject"},o.aryMethod={1:["assignAll","assignInAll","attempt","castArray","ceil","create","curry","curryRight","defaultsAll","defaultsDeepAll","floor","flow","flowRight","fromPairs","invert","iteratee","memoize","method","mergeAll","methodOf","mixin","nthArg","over","overEvery","overSome","rest","reverse","round","runInContext","spread","template","trim","trimEnd","trimStart","uniqueId","words","zipAll"],2:["add","after","ary","assign","assignAllWith","assignIn","assignInAllWith","at","before","bind","bindAll","bindKey","chunk","cloneDeepWith","cloneWith","concat","conformsTo","countBy","curryN","curryRightN","debounce","defaults","defaultsDeep","defaultTo","delay","difference","divide","drop","dropRight","dropRightWhile","dropWhile","endsWith","eq","every","filter","find","findIndex","findKey","findLast","findLastIndex","findLastKey","flatMap","flatMapDeep","flattenDepth","forEach","forEachRight","forIn","forInRight","forOwn","forOwnRight","get","groupBy","gt","gte","has","hasIn","includes","indexOf","intersection","invertBy","invoke","invokeMap","isEqual","isMatch","join","keyBy","lastIndexOf","lt","lte","map","mapKeys","mapValues","matchesProperty","maxBy","meanBy","merge","mergeAllWith","minBy","multiply","nth","omit","omitBy","overArgs","pad","padEnd","padStart","parseInt","partial","partialRight","partition","pick","pickBy","propertyOf","pull","pullAll","pullAt","random","range","rangeRight","rearg","reject","remove","repeat","restFrom","result","sampleSize","some","sortBy","sortedIndex","sortedIndexOf","sortedLastIndex","sortedLastIndexOf","sortedUniqBy","split","spreadFrom","startsWith","subtract","sumBy","take","takeRight","takeRightWhile","takeWhile","tap","throttle","thru","times","trimChars","trimCharsEnd","trimCharsStart","truncate","union","uniqBy","uniqWith","unset","unzipWith","without","wrap","xor","zip","zipObject","zipObjectDeep"],3:["assignInWith","assignWith","clamp","differenceBy","differenceWith","findFrom","findIndexFrom","findLastFrom","findLastIndexFrom","getOr","includesFrom","indexOfFrom","inRange","intersectionBy","intersectionWith","invokeArgs","invokeArgsMap","isEqualWith","isMatchWith","flatMapDepth","lastIndexOfFrom","mergeWith","orderBy","padChars","padCharsEnd","padCharsStart","pullAllBy","pullAllWith","rangeStep","rangeStepRight","reduce","reduceRight","replace","set","slice","sortedIndexBy","sortedLastIndexBy","transform","unionBy","unionWith","update","xorBy","xorWith","zipWith"],4:["fill","setWith","updateWith"]},o.aryRearg={2:[1,0],3:[2,0,1],4:[3,2,0,1]},o.iterateeAry={dropRightWhile:1,dropWhile:1,every:1,filter:1,find:1,findFrom:1,findIndex:1,findIndexFrom:1,findKey:1,findLast:1,findLastFrom:1,findLastIndex:1,findLastIndexFrom:1,findLastKey:1,flatMap:1,flatMapDeep:1,flatMapDepth:1,forEach:1,forEachRight:1,forIn:1,forInRight:1,forOwn:1,forOwnRight:1,map:1,mapKeys:1,mapValues:1,partition:1,reduce:2,reduceRight:2,reject:1,remove:1,some:1,takeRightWhile:1,takeWhile:1,times:1,transform:2},o.iterateeRearg={mapKeys:[1],reduceRight:[1,0]},o.methodRearg={assignInAllWith:[1,0],assignInWith:[1,2,0],assignAllWith:[1,0],assignWith:[1,2,0],differenceBy:[1,2,0],differenceWith:[1,2,0],getOr:[2,1,0],intersectionBy:[1,2,0],intersectionWith:[1,2,0],isEqualWith:[1,2,0],isMatchWith:[2,1,0],mergeAllWith:[1,0],mergeWith:[1,2,0],padChars:[2,1,0],padCharsEnd:[2,1,0],padCharsStart:[2,1,0],pullAllBy:[2,1,0],pullAllWith:[2,1,0],rangeStep:[1,2,0],rangeStepRight:[1,2,0],setWith:[3,1,2,0],sortedIndexBy:[2,1,0],sortedLastIndexBy:[2,1,0],unionBy:[1,2,0],unionWith:[1,2,0],updateWith:[3,1,2,0],xorBy:[1,2,0],xorWith:[1,2,0],zipWith:[1,2,0]},o.methodSpread={assignAll:{start:0},assignAllWith:{start:0},assignInAll:{start:0},assignInAllWith:{start:0},defaultsAll:{start:0},defaultsDeepAll:{start:0},invokeArgs:{start:2},invokeArgsMap:{start:2},mergeAll:{start:0},mergeAllWith:{start:0},partial:{start:1},partialRight:{start:1},without:{start:1},zipAll:{start:0}},o.mutate={array:{fill:!0,pull:!0,pullAll:!0,pullAllBy:!0,pullAllWith:!0,pullAt:!0,remove:!0,reverse:!0},object:{assign:!0,assignAll:!0,assignAllWith:!0,assignIn:!0,assignInAll:!0,assignInAllWith:!0,assignInWith:!0,assignWith:!0,defaults:!0,defaultsAll:!0,defaultsDeep:!0,defaultsDeepAll:!0,merge:!0,mergeAll:!0,mergeAllWith:!0,mergeWith:!0},set:{set:!0,setWith:!0,unset:!0,update:!0,updateWith:!0}},o.placeholder={bind:!0,bindKey:!0,curry:!0,curryRight:!0,partial:!0,partialRight:!0},o.realToAlias=function(){var e=Object.prototype.hasOwnProperty,t=o.aliasToReal,r={};for(var n in t){var a=t[n];e.call(r,a)?r[a].push(n):r[a]=[n]}return r}(),o.remap={assignAll:"assign",assignAllWith:"assignWith",assignInAll:"assignIn",assignInAllWith:"assignInWith",curryN:"curry",curryRightN:"curryRight",defaultsAll:"defaults",defaultsDeepAll:"defaultsDeep",findFrom:"find",findIndexFrom:"findIndex",findLastFrom:"findLast",findLastIndexFrom:"findLastIndex",getOr:"get",includesFrom:"includes",indexOfFrom:"indexOf",invokeArgs:"invoke",invokeArgsMap:"invokeMap",lastIndexOfFrom:"lastIndexOf",mergeAll:"merge",mergeAllWith:"mergeWith",padChars:"pad",padCharsEnd:"padEnd",padCharsStart:"padStart",propertyOf:"get",rangeStep:"range",rangeStepRight:"rangeRight",restFrom:"rest",spreadFrom:"spread",trimChars:"trim",trimCharsEnd:"trimEnd",trimCharsStart:"trimStart",zipAll:"zip"},o.skipFixed={castArray:!0,flow:!0,flowRight:!0,iteratee:!0,mixin:!0,rearg:!0,runInContext:!0},o.skipRearg={add:!0,assign:!0,assignIn:!0,bind:!0,bindKey:!0,concat:!0,difference:!0,divide:!0,eq:!0,gt:!0,gte:!0,isEqual:!0,lt:!0,lte:!0,matchesProperty:!0,merge:!0,multiply:!0,overArgs:!0,partial:!0,partialRight:!0,propertyOf:!0,random:!0,range:!0,rangeRight:!0,subtract:!0,zip:!0,zipObject:!0,zipObjectDeep:!0}}),ir={},ur=Array.prototype.push;function cr(r,e){return 2==e?function(e,t){return r(e,t)}:function(e){return r(e)}}function sr(e){for(var t=e?e.length:0,r=Array(t);t--;)r[t]=e[t];return r}function fr(n,a){return function(){var e=arguments.length;if(e){for(var t=Array(e);e--;)t[e]=arguments[e];var r=t[0]=a.apply(void 0,t);return n.apply(void 0,t),r}}}var pr=function c(r,e,t,n){var a,s="function"==typeof e,o=e===Object(e);if(o&&(n=t,t=e,e=void 0),null==t)throw new TypeError;n||(n={});var f={cap:!("cap"in n)||n.cap,curry:!("curry"in n)||n.curry,fixed:!("fixed"in n)||n.fixed,immutable:!("immutable"in n)||n.immutable,rearg:!("rearg"in n)||n.rearg},p="curry"in n&&n.curry,u="fixed"in n&&n.fixed,i="rearg"in n&&n.rearg,l=s?t:ir,d=s?t.runInContext():void 0,v=s?t:{ary:r.ary,assign:r.assign,clone:r.clone,curry:r.curry,forEach:r.forEach,isArray:r.isArray,isError:r.isError,isFunction:r.isFunction,isWeakMap:r.isWeakMap,iteratee:r.iteratee,keys:r.keys,rearg:r.rearg,toInteger:r.toInteger,toPath:r.toPath},m=v.ary,h=v.assign,g=v.clone,y=v.curry,x=v.forEach,b=v.isArray,_=v.isError,w=v.isFunction,I=v.isWeakMap,k=v.keys,A=v.rearg,E=v.toInteger,R=v.toPath,T=k(or.aryMethod),P={castArray:function(t){return function(){var e=arguments[0];return b(e)?t(sr(e)):t.apply(void 0,arguments)}},iteratee:function(n){return function(){var e=arguments[1],t=n(arguments[0],e),r=t.length;return f.cap&&"number"==typeof e?(e=2<e?e-2:1,r&&r<=e?t:cr(t,e)):t}},mixin:function(e){return function(t){var r=this;if(!w(r))return e(r,Object(t));var n=[];return x(k(t),function(e){w(t[e])&&n.push([e,r.prototype[e]])}),e(r,Object(t)),x(n,function(e){var t=e[1];w(t)?r.prototype[e[0]]=t:delete r.prototype[e[0]]}),r}},nthArg:function(r){return function(e){var t=e<0?1:E(e)+1;return y(r(e),t)}},rearg:function(n){return function(e,t){var r=t?t.length:0;return y(n(e,t),r)}},runInContext:function(t){return function(e){return c(r,t(e),n)}}};function S(e,t){if(f.cap){var r=or.iterateeRearg[e];if(r)return o=r,M(t,function(e){var r,t=o.length;return r=A(cr(e,t),o),2==t?function(e,t){return r.apply(void 0,arguments)}:function(e){return r.apply(void 0,arguments)}});var n=!s&&or.iterateeAry[e];if(n)return a=n,M(t,function(e){return"function"==typeof e?cr(e,a):e})}var a,o;return t}function O(e,t,r){if(f.fixed&&(u||!or.skipFixed[e])){var n=or.methodSpread[e],a=n&&n.start;return void 0===a?m(t,r):(o=t,i=a,function(){for(var e=arguments.length,t=e-1,r=Array(e);e--;)r[e]=arguments[e];var n=r[i],a=r.slice(0,i);return n&&ur.apply(a,n),i!=t&&ur.apply(a,r.slice(i+1)),o.apply(this,a)})}var o,i;return t}function C(e,t,r){return f.rearg&&1<r&&(i||!or.skipRearg[e])?A(t,or.methodRearg[e]||or.aryRearg[r]):t}function j(e,t){for(var r=-1,n=(t=R(t)).length,a=n-1,o=g(Object(e)),i=o;null!=i&&++r<n;){var u=t[r],c=i[u];null==c||w(c)||_(c)||I(c)||(i[u]=g(r==a?c:Object(c))),i=i[u]}return o}function N(e,a){var o=or.aliasToReal[e]||e,i=or.remap[o]||o,u=n;return function(e){var t=s?d:v,r=s?d[i]:a,n=h(h({},u),e);return c(t,o,r,n)}}function M(n,a){return function(){var e=arguments.length;if(!e)return n();for(var t=Array(e);e--;)t[e]=arguments[e];var r=f.rearg?0:e-1;return t[r]=a(t[r]),n.apply(void 0,t)}}function L(e,t){var o,r,i=or.aliasToReal[e]||e,u=t,n=P[i];return n?u=n(t):f.immutable&&(or.mutate.array[i]?u=fr(t,sr):or.mutate.object[i]?u=fr(t,(r=t,function(e){return r({},e)})):or.mutate.set[i]&&(u=fr(t,j))),x(T,function(a){return x(or.aryMethod[a],function(e){if(i==e){var t=or.methodSpread[i];return o=t&&t.afterRearg?O(i,C(i,u,a),a):C(i,O(i,u,a),a),o=S(i,o),r=o,n=a,o=p||f.curry&&1<n?y(r,n):r,!1}var r,n}),!o}),o||(o=u),o==t&&(o=p?y(o,1):function(){return t.apply(this,arguments)}),o.convert=N(i,t),or.placeholder[i]&&(a=!0,o.placeholder=t.placeholder=l),o}if(!o)return L(e,t);var D=t,F=[];return x(T,function(e){x(or.aryMethod[e],function(e){var t=D[or.remap[e]||e];t&&F.push([e,L(e,t)])})}),x(k(D),function(e){var t=D[e];if("function"==typeof t){for(var r=F.length;r--;)if(F[r][0]==e)return;t.convert=N(e,t),F.push([e,t])}}),x(F,function(e){D[e[0]]=e[1]}),D.convert=function(e){return D.runInContext.convert(e)(void 0)},a&&(D.placeholder=l),x(k(D),function(t){x(or.realToAlias[t]||[],function(e){D[e]=D[t]})}),D};var lr=function(e){return e},dr="object"==typeof t&&t&&t.Object===Object&&t,vr="object"==typeof self&&self&&self.Object===Object&&self,mr=dr||vr||Function("return this")(),hr=mr.Symbol,gr=Object.prototype,yr=gr.hasOwnProperty,xr=gr.toString,br=hr?hr.toStringTag:void 0;var _r=function(e){var t=yr.call(e,br),r=e[br];try{var n=!(e[br]=void 0)}catch(e){}var a=xr.call(e);return n&&(t?e[br]=r:delete e[br]),a},wr=Object.prototype.toString;var Ir=function(e){return wr.call(e)},kr=hr?hr.toStringTag:void 0;var Ar=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":kr&&kr in Object(e)?_r(e):Ir(e)};var Er=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var Rr,Tr=function(e){if(!Er(e))return!1;var t=Ar(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Pr=mr["__core-js_shared__"],Sr=(Rr=/[^.]+$/.exec(Pr&&Pr.keys&&Pr.keys.IE_PROTO||""))?"Symbol(src)_1."+Rr:"";var Or=function(e){return!!Sr&&Sr in e},Cr=Function.prototype.toString;var jr=function(e){if(null!=e){try{return Cr.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Nr=/^\[object .+?Constructor\]$/,Mr=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Lr=function(e){return!(!Er(e)||Or(e))&&(Tr(e)?Mr:Nr).test(jr(e))};var Dr=function(e,t){return null==e?void 0:e[t]};var Fr=function(e,t){var r=Dr(e,t);return Lr(r)?r:void 0},Ur=Fr(mr,"WeakMap"),Wr=Ur&&new Ur,Gr=Wr?function(e,t){return Wr.set(e,t),e}:lr,Br=Object.create,qr=function(){function r(){}return function(e){if(!Er(e))return{};if(Br)return Br(e);r.prototype=e;var t=new r;return r.prototype=void 0,t}}();var Vr=function(n){return function(){var e=arguments;switch(e.length){case 0:return new n;case 1:return new n(e[0]);case 2:return new n(e[0],e[1]);case 3:return new n(e[0],e[1],e[2]);case 4:return new n(e[0],e[1],e[2],e[3]);case 5:return new n(e[0],e[1],e[2],e[3],e[4]);case 6:return new n(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new n(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var t=qr(n.prototype),r=n.apply(t,e);return Er(r)?r:t}};var zr=function(t,e,r){var n=1&e,a=Vr(t);return function e(){return(this&&this!==mr&&this instanceof e?a:t).apply(n?r:this,arguments)}};var Hr=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Kr=Math.max;var Yr=function(e,t,r,n){for(var a=-1,o=e.length,i=r.length,u=-1,c=t.length,s=Kr(o-i,0),f=Array(c+s),p=!n;++u<c;)f[u]=t[u];for(;++a<i;)(p||a<o)&&(f[r[a]]=e[a]);for(;s--;)f[u++]=e[a++];return f},$r=Math.max;var Jr=function(e,t,r,n){for(var a=-1,o=e.length,i=-1,u=r.length,c=-1,s=t.length,f=$r(o-u,0),p=Array(f+s),l=!n;++a<f;)p[a]=e[a];for(var d=a;++c<s;)p[d+c]=t[c];for(;++i<u;)(l||a<o)&&(p[d+r[i]]=e[a++]);return p};var Qr=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n};var Zr=function(){};function Xr(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}var en=(Xr.prototype=qr(Zr.prototype)).constructor=Xr;var tn=Wr?function(e){return Wr.get(e)}:function(){},rn={},nn=Object.prototype.hasOwnProperty;var an=function(e){for(var t=e.name+"",r=rn[t],n=nn.call(rn,t)?r.length:0;n--;){var a=r[n],o=a.func;if(null==o||o==e)return a.name}return t};function on(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}var un=(on.prototype=qr(Zr.prototype)).constructor=on,cn=Array.isArray;var sn=function(e){return null!=e&&"object"==typeof e};var fn=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var pn=function(e){if(e instanceof en)return e.clone();var t=new un(e.__wrapped__,e.__chain__);return t.__actions__=fn(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t},ln=Object.prototype.hasOwnProperty;function dn(e){if(sn(e)&&!cn(e)&&!(e instanceof en)){if(e instanceof un)return e;if(ln.call(e,"__wrapped__"))return pn(e)}return new un(e)}var vn=(dn.prototype=Zr.prototype).constructor=dn;var mn=function(e){var t=an(e),r=vn[t];if("function"!=typeof r||!(t in en.prototype))return!1;if(e===r)return!0;var n=tn(r);return!!n&&e===n[0]},hn=Date.now;var gn=function(r){var n=0,a=0;return function(){var e=hn(),t=16-(e-a);if(a=e,0<t){if(800<=++n)return arguments[0]}else n=0;return r.apply(void 0,arguments)}},yn=gn(Gr),xn=/\{\n\/\* \[wrapped with (.+)\] \*/,bn=/,? & /;var _n=function(e){var t=e.match(xn);return t?t[1].split(bn):[]},wn=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;var In=function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(1<r?"& ":"")+t[n],t=t.join(2<r?", ":" "),e.replace(wn,"{\n/* [wrapped with "+t+"] */\n")};var kn=function(e){return function(){return e}},An=function(){try{var e=Fr(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),En=gn(An?function(e,t){return An(e,"toString",{configurable:!0,enumerable:!1,value:kn(t),writable:!0})}:lr);var Rn=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e};var Tn=function(e,t,r,n){for(var a=e.length,o=r+(n?1:-1);n?o--:++o<a;)if(t(e[o],o,e))return o;return-1};var Pn=function(e){return e!=e};var Sn=function(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1};var On=function(e,t,r){return t==t?Sn(e,t,r):Tn(e,Pn,r)};var Cn=function(e,t){return!(null==e||!e.length)&&-1<On(e,t,0)},jn=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];var Nn=function(r,n){return Rn(jn,function(e){var t="_."+e[0];n&e[1]&&!Cn(r,t)&&r.push(t)}),r.sort()};var Mn=function(e,t,r){var n=t+"";return En(e,In(n,Nn(_n(n),r)))};var Ln=function(e,t,r,n,a,o,i,u,c,s){var f=8&t;t|=f?32:64,4&(t&=~(f?64:32))||(t&=-4);var p=[e,t,a,f?o:void 0,f?i:void 0,f?void 0:o,f?void 0:i,u,c,s],l=r.apply(void 0,p);return mn(e)&&yn(l,p),l.placeholder=n,Mn(l,e,t)};var Dn=function(e){return e.placeholder},Fn=/^(?:0|[1-9]\d*)$/;var Un=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Fn.test(e))&&-1<e&&e%1==0&&e<t},Wn=Math.min;var Gn=function(e,t){for(var r=e.length,n=Wn(t.length,r),a=fn(e);n--;){var o=t[n];e[n]=Un(o,r)?a[o]:void 0}return e},Bn="__lodash_placeholder__";var qn=function(e,t){for(var r=-1,n=e.length,a=0,o=[];++r<n;){var i=e[r];i!==t&&i!==Bn||(e[r]=Bn,o[a++]=r)}return o},Vn=1,zn=2,Hn=8,Kn=16,Yn=128,$n=512;var Jn=function s(f,p,l,d,v,m,h,g,y,x){var b=p&Yn,_=p&Vn,w=p&zn,I=p&(Hn|Kn),k=p&$n,A=w?void 0:Vr(f);return function e(){for(var t=arguments.length,r=Array(t),n=t;n--;)r[n]=arguments[n];if(I)var a=Dn(e),o=Qr(r,a);if(d&&(r=Yr(r,d,v,I)),m&&(r=Jr(r,m,h,I)),t-=o,I&&t<x){var i=qn(r,a);return Ln(f,p,s,e.placeholder,l,r,i,g,y,x-t)}var u=_?l:this,c=w?u[f]:f;return t=r.length,g?r=Gn(r,g):k&&1<t&&r.reverse(),b&&y<t&&(r.length=y),this&&this!==mr&&this instanceof e&&(c=A||Vr(c)),c.apply(u,r)}};var Qn=function(i,u,c){var s=Vr(i);return function e(){for(var t=arguments.length,r=Array(t),n=t,a=Dn(e);n--;)r[n]=arguments[n];var o=t<3&&r[0]!==a&&r[t-1]!==a?[]:qn(r,a);return(t-=o.length)<c?Ln(i,u,Jn,e.placeholder,void 0,r,o,void 0,void 0,c-t):Hr(this&&this!==mr&&this instanceof e?s:i,this,r)}};var Zn=function(u,e,c,s){var f=1&e,p=Vr(u);return function e(){for(var t=-1,r=arguments.length,n=-1,a=s.length,o=Array(a+r),i=this&&this!==mr&&this instanceof e?p:u;++n<a;)o[n]=s[n];for(;r--;)o[n++]=arguments[++t];return Hr(i,f?c:this,o)}},Xn="__lodash_placeholder__",ea=Math.min;var ta=function(e,t){var r=e[1],n=t[1],a=r|n;if(a>=131&&!(128==n&&8==r||128==n&&256==r&&e[7].length<=t[8]||384==n&&t[7].length<=t[8]&&8==r))return e;1&n&&(e[2]=t[2],a|=1&r?0:4);var o=t[3];if(o){var i=e[3];e[3]=i?Yr(i,o,t[4]):o,e[4]=i?qn(e[3],Xn):t[4]}return(o=t[5])&&(e[5]=(i=e[5])?Jr(i,o,t[6]):o,e[6]=i?qn(e[5],Xn):t[6]),(o=t[7])&&(e[7]=o),128&n&&(e[8]=null==e[8]?t[8]:ea(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=a,e};var ra=function(e){return"symbol"==typeof e||sn(e)&&"[object Symbol]"==Ar(e)},na=/^\s+|\s+$/g,aa=/^[-+]0x[0-9a-f]+$/i,oa=/^0b[01]+$/i,ia=/^0o[0-7]+$/i,ua=parseInt;var ca=function(e){if("number"==typeof e)return e;if(ra(e))return NaN;if(Er(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Er(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(na,"");var r=oa.test(e);return r||ia.test(e)?ua(e.slice(2),r?2:8):aa.test(e)?NaN:+e};var sa=function(e){return e?(e=ca(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var fa=function(e){var t=sa(e),r=t%1;return t==t?r?t-r:t:0},pa=Math.max;var la=function(e,t,r,n,a,o,i,u){var c=2&t;if(!c&&"function"!=typeof e)throw new TypeError("Expected a function");var s=n?n.length:0;if(s||(t&=-97,n=a=void 0),i=void 0===i?i:pa(fa(i),0),u=void 0===u?u:fa(u),s-=a?a.length:0,64&t){var f=n,p=a;n=a=void 0}var l=c?void 0:tn(e),d=[e,t,r,n,a,f,p,o,i,u];if(l&&ta(d,l),e=d[0],t=d[1],r=d[2],n=d[3],a=d[4],!(u=d[9]=void 0===d[9]?c?0:e.length:pa(d[9]-s,0))&&24&t&&(t&=-25),t&&1!=t)v=8==t||16==t?Qn(e,t,u):32!=t&&33!=t||a.length?Jn.apply(void 0,d):Zn(e,t,r,n);else var v=zr(e,t,r);return Mn((l?Gr:yn)(v,d),e,t)};var da=function(e,t,r){return t=r?void 0:t,la(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)};var va=function(e,t,r){"__proto__"==t&&An?An(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r};var ma=function(e,t){return e===t||e!=e&&t!=t},ha=Object.prototype.hasOwnProperty;var ga=function(e,t,r){var n=e[t];ha.call(e,t)&&ma(n,r)&&(void 0!==r||t in e)||va(e,t,r)};var ya=function(e,t,r,n){var a=!r;r||(r={});for(var o=-1,i=t.length;++o<i;){var u=t[o],c=n?n(r[u],e[u],u,r,e):void 0;void 0===c&&(c=e[u]),a?va(r,u,c):ga(r,u,c)}return r};var xa=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var ba=function(e){return sn(e)&&"[object Arguments]"==Ar(e)},_a=Object.prototype,wa=_a.hasOwnProperty,Ia=_a.propertyIsEnumerable,ka=ba(function(){return arguments}())?ba:function(e){return sn(e)&&wa.call(e,"callee")&&!Ia.call(e,"callee")};var Aa=function(){return!1},Ea=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?mr.Buffer:void 0;e.exports=(a?a.isBuffer:void 0)||Aa});var Ra=function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991},Ta={};Ta["[object Float32Array]"]=Ta["[object Float64Array]"]=Ta["[object Int8Array]"]=Ta["[object Int16Array]"]=Ta["[object Int32Array]"]=Ta["[object Uint8Array]"]=Ta["[object Uint8ClampedArray]"]=Ta["[object Uint16Array]"]=Ta["[object Uint32Array]"]=!0,Ta["[object Arguments]"]=Ta["[object Array]"]=Ta["[object ArrayBuffer]"]=Ta["[object Boolean]"]=Ta["[object DataView]"]=Ta["[object Date]"]=Ta["[object Error]"]=Ta["[object Function]"]=Ta["[object Map]"]=Ta["[object Number]"]=Ta["[object Object]"]=Ta["[object RegExp]"]=Ta["[object Set]"]=Ta["[object String]"]=Ta["[object WeakMap]"]=!1;var Pa=function(e){return sn(e)&&Ra(e.length)&&!!Ta[Ar(e)]};var Sa=function(t){return function(e){return t(e)}},Oa=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r&&dr.process,o=function(){try{var e=n&&n.require&&n.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=o}),Ca=Oa&&Oa.isTypedArray,ja=Ca?Sa(Ca):Pa,Na=Object.prototype.hasOwnProperty;var Ma=function(e,t){var r=cn(e),n=!r&&ka(e),a=!r&&!n&&Ea(e),o=!r&&!n&&!a&&ja(e),i=r||n||a||o,u=i?xa(e.length,String):[],c=u.length;for(var s in e)!t&&!Na.call(e,s)||i&&("length"==s||a&&("offset"==s||"parent"==s)||o&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Un(s,c))||u.push(s);return u},La=Object.prototype;var Da=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||La)};var Fa=function(t,r){return function(e){return t(r(e))}},Ua=Fa(Object.keys,Object),Wa=Object.prototype.hasOwnProperty;var Ga=function(e){if(!Da(e))return Ua(e);var t=[];for(var r in Object(e))Wa.call(e,r)&&"constructor"!=r&&t.push(r);return t};var Ba=function(e){return null!=e&&Ra(e.length)&&!Tr(e)};var qa=function(e){return Ba(e)?Ma(e):Ga(e)};var Va=function(e,t){return e&&ya(t,qa(t),e)};var za=function(e,t){for(var r=e.length;r--;)if(ma(e[r][0],t))return r;return-1},Ha=Array.prototype.splice;var Ka=function(e){var t=this.__data__,r=za(t,e);return 0<=r&&(r==t.length-1?t.pop():Ha.call(t,r,1),--this.size,!0)};var Ya=function(e){var t=this.__data__,r=za(t,e);return r<0?void 0:t[r][1]};var $a=function(e){return-1<za(this.__data__,e)};var Ja=function(e,t){var r=this.__data__,n=za(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function Qa(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Qa.prototype.clear=function(){this.__data__=[],this.size=0},Qa.prototype.delete=Ka,Qa.prototype.get=Ya,Qa.prototype.has=$a,Qa.prototype.set=Ja;var Za=Qa;var Xa=function(){this.__data__=new Za,this.size=0};var eo=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var to=function(e){return this.__data__.get(e)};var ro=function(e){return this.__data__.has(e)},no=Fr(mr,"Map"),ao=Fr(Object,"create");var oo=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},io=Object.prototype.hasOwnProperty;var uo=function(e){var t=this.__data__;if(ao){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return io.call(t,e)?t[e]:void 0},co=Object.prototype.hasOwnProperty;var so=function(e){var t=this.__data__;return ao?void 0!==t[e]:co.call(t,e)};var fo=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=ao&&void 0===t?"__lodash_hash_undefined__":t,this};function po(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}po.prototype.clear=function(){this.__data__=ao?ao(null):{},this.size=0},po.prototype.delete=oo,po.prototype.get=uo,po.prototype.has=so,po.prototype.set=fo;var lo=po;var vo=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var mo=function(e,t){var r=e.__data__;return vo(t)?r["string"==typeof t?"string":"hash"]:r.map};var ho=function(e){var t=mo(this,e).delete(e);return this.size-=t?1:0,t};var go=function(e){return mo(this,e).get(e)};var yo=function(e){return mo(this,e).has(e)};var xo=function(e,t){var r=mo(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function bo(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}bo.prototype.clear=function(){this.size=0,this.__data__={hash:new lo,map:new(no||Za),string:new lo}},bo.prototype.delete=ho,bo.prototype.get=go,bo.prototype.has=yo,bo.prototype.set=xo;var _o=bo;var wo=function(e,t){var r=this.__data__;if(r instanceof Za){var n=r.__data__;if(!no||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new _o(n)}return r.set(e,t),this.size=r.size,this};function Io(e){var t=this.__data__=new Za(e);this.size=t.size}Io.prototype.clear=Xa,Io.prototype.delete=eo,Io.prototype.get=to,Io.prototype.has=ro,Io.prototype.set=wo;var ko=Io;var Ao=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},Eo=Object.prototype.hasOwnProperty;var Ro=function(e){if(!Er(e))return Ao(e);var t=Da(e),r=[];for(var n in e)("constructor"!=n||!t&&Eo.call(e,n))&&r.push(n);return r};var To=function(e){return Ba(e)?Ma(e,!0):Ro(e)};var Po=function(e,t){return e&&ya(t,To(t),e)},So=r(function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?mr.Buffer:void 0,o=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=o?o(r):new e.constructor(r);return e.copy(n),n}});var Oo=function(e,t){for(var r=-1,n=null==e?0:e.length,a=0,o=[];++r<n;){var i=e[r];t(i,r,e)&&(o[a++]=i)}return o};var Co=function(){return[]},jo=Object.prototype.propertyIsEnumerable,No=Object.getOwnPropertySymbols,Mo=No?function(t){return null==t?[]:Oo(No(t=Object(t)),function(e){return jo.call(t,e)})}:Co;var Lo=function(e,t){return ya(e,Mo(e),t)};var Do=function(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e},Fo=Fa(Object.getPrototypeOf,Object),Uo=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Do(t,Mo(e)),e=Fo(e);return t}:Co;var Wo=function(e,t){return ya(e,Uo(e),t)};var Go=function(e,t,r){var n=t(e);return cn(e)?n:Do(n,r(e))};var Bo=function(e){return Go(e,qa,Mo)};var qo=function(e){return Go(e,To,Uo)},Vo=Fr(mr,"DataView"),zo=Fr(mr,"Promise"),Ho=Fr(mr,"Set"),Ko="[object Map]",Yo="[object Promise]",$o="[object Set]",Jo="[object WeakMap]",Qo="[object DataView]",Zo=jr(Vo),Xo=jr(no),ei=jr(zo),ti=jr(Ho),ri=jr(Ur),ni=Ar;(Vo&&ni(new Vo(new ArrayBuffer(1)))!=Qo||no&&ni(new no)!=Ko||zo&&ni(zo.resolve())!=Yo||Ho&&ni(new Ho)!=$o||Ur&&ni(new Ur)!=Jo)&&(ni=function(e){var t=Ar(e),r="[object Object]"==t?e.constructor:void 0,n=r?jr(r):"";if(n)switch(n){case Zo:return Qo;case Xo:return Ko;case ei:return Yo;case ti:return $o;case ri:return Jo}return t});var ai=ni,oi=Object.prototype.hasOwnProperty;var ii=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&oi.call(e,"index")&&(r.index=e.index,r.input=e.input),r},ui=mr.Uint8Array;var ci=function(e){var t=new e.constructor(e.byteLength);return new ui(t).set(new ui(e)),t};var si=function(e,t){var r=t?ci(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},fi=/\w*$/;var pi=function(e){var t=new e.constructor(e.source,fi.exec(e));return t.lastIndex=e.lastIndex,t},li=hr?hr.prototype:void 0,di=li?li.valueOf:void 0;var vi=function(e){return di?Object(di.call(e)):{}};var mi=function(e,t){var r=t?ci(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)};var hi=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return ci(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return si(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return mi(e,r);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return pi(e);case"[object Set]":return new n;case"[object Symbol]":return vi(e)}};var gi=function(e){return"function"!=typeof e.constructor||Da(e)?{}:qr(Fo(e))};var yi=function(e){return sn(e)&&"[object Map]"==ai(e)},xi=Oa&&Oa.isMap,bi=xi?Sa(xi):yi;var _i=function(e){return sn(e)&&"[object Set]"==ai(e)},wi=Oa&&Oa.isSet,Ii=wi?Sa(wi):_i,ki=1,Ai=2,Ei=4,Ri="[object Arguments]",Ti="[object Function]",Pi="[object GeneratorFunction]",Si="[object Object]",Oi={};Oi[Ri]=Oi["[object Array]"]=Oi["[object ArrayBuffer]"]=Oi["[object DataView]"]=Oi["[object Boolean]"]=Oi["[object Date]"]=Oi["[object Float32Array]"]=Oi["[object Float64Array]"]=Oi["[object Int8Array]"]=Oi["[object Int16Array]"]=Oi["[object Int32Array]"]=Oi["[object Map]"]=Oi["[object Number]"]=Oi[Si]=Oi["[object RegExp]"]=Oi["[object Set]"]=Oi["[object String]"]=Oi["[object Symbol]"]=Oi["[object Uint8Array]"]=Oi["[object Uint8ClampedArray]"]=Oi["[object Uint16Array]"]=Oi["[object Uint32Array]"]=!0,Oi["[object Error]"]=Oi[Ti]=Oi["[object WeakMap]"]=!1;var Ci=function r(n,a,o,e,t,i){var u,c=a&ki,s=a&Ai,f=a&Ei;if(o&&(u=t?o(n,e,t,i):o(n)),void 0!==u)return u;if(!Er(n))return n;var p=cn(n);if(p){if(u=ii(n),!c)return fn(n,u)}else{var l=ai(n),d=l==Ti||l==Pi;if(Ea(n))return So(n,c);if(l==Si||l==Ri||d&&!t){if(u=s||d?{}:gi(n),!c)return s?Wo(n,Po(u,n)):Lo(n,Va(u,n))}else{if(!Oi[l])return t?n:{};u=hi(n,l,c)}}i||(i=new ko);var v=i.get(n);if(v)return v;if(i.set(n,u),Ii(n))return n.forEach(function(e){u.add(r(e,a,o,e,n,i))}),u;if(bi(n))return n.forEach(function(e,t){u.set(t,r(e,a,o,t,n,i))}),u;var m=f?s?qo:Bo:s?keysIn:qa,h=p?void 0:m(n);return Rn(h||n,function(e,t){h&&(e=n[t=e]),ga(u,t,r(e,a,o,t,n,i))}),u};var ji=function(e){return Ci(e,4)},Ni=8;function Mi(e,t,r){var n=la(e,Ni,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return n.placeholder=Mi.placeholder,n}Mi.placeholder={};var Li=Mi,Di=Function.prototype.toString,Fi=Object.prototype.hasOwnProperty,Ui=Di.call(Object);var Wi=function(e){if(!sn(e)||"[object Object]"!=Ar(e))return!1;var t=Fo(e);if(null===t)return!0;var r=Fi.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Di.call(r)==Ui};var Gi=function(e){if(!sn(e))return!1;var t=Ar(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Wi(e)};var Bi=function(e){return sn(e)&&"[object WeakMap]"==ai(e)};var qi=function(e){return this.__data__.has(e)};function Vi(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new _o;++t<r;)this.add(e[t])}Vi.prototype.add=Vi.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Vi.prototype.has=qi;var zi=Vi;var Hi=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1};var Ki=function(e,t){return e.has(t)};var Yi=function(e,t,r,n,a,o){var i=1&r,u=e.length,c=t.length;if(!(u==c||i&&u<c))return!1;var s=o.get(e);if(s&&o.get(t))return s==t;var f=-1,p=!0,l=2&r?new zi:void 0;for(o.set(e,t),o.set(t,e);++f<u;){var d=e[f],v=t[f];if(n)var m=i?n(v,d,f,t,e,o):n(d,v,f,e,t,o);if(void 0!==m){if(m)continue;p=!1;break}if(l){if(!Hi(t,function(e,t){if(!Ki(l,t)&&(d===e||a(d,e,r,n,o)))return l.push(t)})){p=!1;break}}else if(d!==v&&!a(d,v,r,n,o)){p=!1;break}}return o.delete(e),o.delete(t),p};var $i=function(e){var r=-1,n=Array(e.size);return e.forEach(function(e,t){n[++r]=[t,e]}),n};var Ji=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r},Qi=hr?hr.prototype:void 0,Zi=Qi?Qi.valueOf:void 0;var Xi=function(e,t,r,n,a,o,i){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new ui(e),new ui(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return ma(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var u=$i;case"[object Set]":if(u||(u=Ji),e.size!=t.size&&!(1&n))return!1;var c=i.get(e);if(c)return c==t;n|=2,i.set(e,t);var s=Yi(u(e),u(t),n,a,o,i);return i.delete(e),s;case"[object Symbol]":if(Zi)return Zi.call(e)==Zi.call(t)}return!1},eu=Object.prototype.hasOwnProperty;var tu=function(e,t,r,n,a,o){var i=1&r,u=Bo(e),c=u.length;if(c!=Bo(t).length&&!i)return!1;for(var s=c;s--;){var f=u[s];if(!(i?f in t:eu.call(t,f)))return!1}var p=o.get(e);if(p&&o.get(t))return p==t;var l=!0;o.set(e,t),o.set(t,e);for(var d=i;++s<c;){var v=e[f=u[s]],m=t[f];if(n)var h=i?n(m,v,f,t,e,o):n(v,m,f,e,t,o);if(!(void 0===h?v===m||a(v,m,r,n,o):h)){l=!1;break}d||(d="constructor"==f)}if(l&&!d){var g=e.constructor,y=t.constructor;g!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof y&&y instanceof y)&&(l=!1)}return o.delete(e),o.delete(t),l},ru="[object Arguments]",nu="[object Array]",au="[object Object]",ou=Object.prototype.hasOwnProperty;var iu=function(e,t,r,n,a,o){var i=cn(e),u=cn(t),c=i?nu:ai(e),s=u?nu:ai(t),f=(c=c==ru?au:c)==au,p=(s=s==ru?au:s)==au,l=c==s;if(l&&Ea(e)){if(!Ea(t))return!1;f=!(i=!0)}if(l&&!f)return o||(o=new ko),i||ja(e)?Yi(e,t,r,n,a,o):Xi(e,t,c,r,n,a,o);if(!(1&r)){var d=f&&ou.call(e,"__wrapped__"),v=p&&ou.call(t,"__wrapped__");if(d||v){var m=d?e.value():e,h=v?t.value():t;return o||(o=new ko),a(m,h,r,n,o)}}return!!l&&(o||(o=new ko),tu(e,t,r,n,a,o))};var uu=function e(t,r,n,a,o){return t===r||(null==t||null==r||!sn(t)&&!sn(r)?t!=t&&r!=r:iu(t,r,n,a,e,o))};var cu=function(e,t,r,n){var a=r.length,o=a,i=!n;if(null==e)return!o;for(e=Object(e);a--;){var u=r[a];if(i&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++a<o;){var c=(u=r[a])[0],s=e[c],f=u[1];if(i&&u[2]){if(void 0===s&&!(c in e))return!1}else{var p=new ko;if(n)var l=n(s,f,c,e,t,p);if(!(void 0===l?uu(f,s,3,n,p):l))return!1}}return!0};var su=function(e){return e==e&&!Er(e)};var fu=function(e){for(var t=qa(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,su(a)]}return t};var pu=function(t,r){return function(e){return null!=e&&e[t]===r&&(void 0!==r||t in Object(e))}};var lu=function(t){var r=fu(t);return 1==r.length&&r[0][2]?pu(r[0][0],r[0][1]):function(e){return e===t||cu(e,t,r)}},du=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,vu=/^\w*$/;var mu=function(e,t){if(cn(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!ra(e))||vu.test(e)||!du.test(e)||null!=t&&e in Object(t)},hu="Expected a function";function gu(a,o){if("function"!=typeof a||null!=o&&"function"!=typeof o)throw new TypeError(hu);var i=function(){var e=arguments,t=o?o.apply(this,e):e[0],r=i.cache;if(r.has(t))return r.get(t);var n=a.apply(this,e);return i.cache=r.set(t,n)||r,n};return i.cache=new(gu.Cache||_o),i}gu.Cache=_o;var yu=gu;var xu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bu=/\\(\\)?/g,_u=function(e){var t=yu(e,function(e){return 500===r.size&&r.clear(),e}),r=t.cache;return t}(function(e){var a=[];return 46===e.charCodeAt(0)&&a.push(""),e.replace(xu,function(e,t,r,n){a.push(r?n.replace(bu,"$1"):t||e)}),a});var wu=function(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a},Iu=1/0,ku=hr?hr.prototype:void 0,Au=ku?ku.toString:void 0;var Eu=function e(t){if("string"==typeof t)return t;if(cn(t))return wu(t,e)+"";if(ra(t))return Au?Au.call(t):"";var r=t+"";return"0"==r&&1/t==-Iu?"-0":r};var Ru=function(e){return null==e?"":Eu(e)};var Tu=function(e,t){return cn(e)?e:mu(e,t)?[e]:_u(Ru(e))};var Pu=function(e){if("string"==typeof e||ra(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t};var Su=function(e,t){for(var r=0,n=(t=Tu(t,e)).length;null!=e&&r<n;)e=e[Pu(t[r++])];return r&&r==n?e:void 0};var Ou=function(e,t,r){var n=null==e?void 0:Su(e,t);return void 0===n?r:n};var Cu=function(e,t){return null!=e&&t in Object(e)};var ju=function(e,t,r){for(var n=-1,a=(t=Tu(t,e)).length,o=!1;++n<a;){var i=Pu(t[n]);if(!(o=null!=e&&r(e,i)))break;e=e[i]}return o||++n!=a?o:!!(a=null==e?0:e.length)&&Ra(a)&&Un(i,a)&&(cn(e)||ka(e))};var Nu=function(e,t){return null!=e&&ju(e,t,Cu)};var Mu=function(r,n){return mu(r)&&su(n)?pu(Pu(r),n):function(e){var t=Ou(e,r);return void 0===t&&t===n?Nu(e,r):uu(n,t,3)}};var Lu=function(t){return function(e){return null==e?void 0:e[t]}};var Du=function(t){return function(e){return Su(e,t)}};var Fu=function(e){return mu(e)?Lu(Pu(e)):Du(e)};var Uu=function(e){return"function"==typeof e?e:null==e?lr:"object"==typeof e?cn(e)?Mu(e[0],e[1]):lu(e):Fu(e)};var Wu=function(e){return Uu("function"==typeof e?e:Ci(e,1))},Gu=hr?hr.isConcatSpreadable:void 0;var Bu=function(e){return cn(e)||ka(e)||!!(Gu&&e&&e[Gu])};var qu=function e(t,r,n,a,o){var i=-1,u=t.length;for(n||(n=Bu),o||(o=[]);++i<u;){var c=t[i];0<r&&n(c)?1<r?e(c,r-1,n,a,o):Do(o,c):a||(o[o.length]=c)}return o};var Vu=function(e){return null!=e&&e.length?qu(e,1):[]},zu=Math.max;var Hu=function(o,i,u){return i=zu(void 0===i?o.length-1:i,0),function(){for(var e=arguments,t=-1,r=zu(e.length-i,0),n=Array(r);++t<r;)n[t]=e[i+t];t=-1;for(var a=Array(i+1);++t<i;)a[t]=e[t];return a[i]=u(n),Hr(o,this,a)}};var Ku=function(e){return En(Hu(e,void 0,Vu),e+"")},Yu=Ku(function(e,t){return la(e,256,void 0,void 0,void 0,t)});var $u=function(e){return cn(e)?wu(e,Pu):ra(e)?[e]:fn(_u(Ru(e)))},Ju={ary:da,assign:Va,clone:ji,curry:Li,forEach:Rn,isArray:cn,isError:Gi,isFunction:Tr,isWeakMap:Bi,iteratee:Wu,keys:Ga,rearg:Yu,toInteger:fa,toPath:$u};var Qu=function(e,t,r){return pr(Ju,e,t,r)};var Zu=function(c){return function(e,t,r){for(var n=-1,a=Object(e),o=r(e),i=o.length;i--;){var u=o[c?i:++n];if(!1===t(a[u],u,a))break}return e}}();var Xu=function(e,t){return e&&Zu(e,t,qa)};var ec=function(o,i){return function(e,t){if(null==e)return e;if(!Ba(e))return o(e,t);for(var r=e.length,n=i?r:-1,a=Object(e);(i?n--:++n<r)&&!1!==t(a[n],n,a););return e}}(Xu);var tc=function(e,n){var a=-1,o=Ba(e)?Array(e.length):[];return ec(e,function(e,t,r){o[++a]=n(e,t,r)}),o};var rc=Qu("map",function(e,t){return(cn(e)?wu:tc)(e,Uu(t,3))});rc.placeholder=ir;var nc=rc;var ac=function(t,e){return wu(e,function(e){return t[e]})};var oc={cap:!1,curry:!1,fixed:!1,immutable:!1,rearg:!1},ic=Qu("values",function(e){return null==e?[]:ac(e,qa(e))},oc);ic.placeholder=ir;var uc=ic;var cc=Qu("flowRight",function(c){return Ku(function(a){var o=a.length,e=o,t=un.prototype.thru;for(c&&a.reverse();e--;){var r=a[e];if("function"!=typeof r)throw new TypeError("Expected a function");if(t&&!i&&"wrapper"==an(r))var i=new un([],!0)}for(e=i?e:o;++e<o;){var n=an(r=a[e]),u="wrapper"==n?tn(r):void 0;i=u&&mn(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?i[an(u[0])].apply(i,u[3]):1==r.length&&mn(r)?i[n]():i.thru(r)}return function(){var e=arguments,t=e[0];if(i&&1==e.length&&cn(t))return i.plant(t).value();for(var r=0,n=o?a[r].apply(this,e):t;++r<o;)n=a[r].call(this,n);return n}})}(!0));cc.placeholder=ir;var sc=cc;var fc=function(e,t,r){(void 0===r||ma(e[t],r))&&(void 0!==r||t in e)||va(e,t,r)};var pc=function(e){return sn(e)&&Ba(e)};var lc=function(e,t){return"__proto__"==t?void 0:e[t]};var dc=function(e){return ya(e,To(e))};var vc=function(e,t,r,n,a,o,i){var u=lc(e,r),c=lc(t,r),s=i.get(c);if(s)fc(e,r,s);else{var f=o?o(u,c,r+"",e,t,i):void 0,p=void 0===f;if(p){var l=cn(c),d=!l&&Ea(c),v=!l&&!d&&ja(c);f=c,l||d||v?f=cn(u)?u:pc(u)?fn(u):d?So(c,!(p=!1)):v?mi(c,!(p=!1)):[]:Wi(c)||ka(c)?ka(f=u)?f=dc(u):(!Er(u)||n&&Tr(u))&&(f=gi(c)):p=!1}p&&(i.set(c,f),a(f,c,n,o,i),i.delete(c)),fc(e,r,f)}};var mc=function n(a,o,i,u,c){a!==o&&Zu(o,function(e,t){if(Er(e))c||(c=new ko),vc(a,o,t,i,n,u,c);else{var r=u?u(lc(a,t),e,t+"",a,o,c):void 0;void 0===r&&(r=e),fc(a,t,r)}},To)};var hc=function(e,t){return En(Hu(e,t,lr),e+"")};var gc=function(e,t,r){if(!Er(r))return!1;var n=typeof t;return!!("number"==n?Ba(r)&&Un(t,r.length):"string"==n&&t in r)&&ma(r[t],e)};var yc=function(u){return hc(function(e,t){var r=-1,n=t.length,a=1<n?t[n-1]:void 0,o=2<n?t[2]:void 0;for(a=3<u.length&&"function"==typeof a?(n--,a):void 0,o&&gc(t[0],t[1],o)&&(a=n<3?void 0:a,n=1),e=Object(e);++r<n;){var i=t[r];i&&u(e,i,r,a)}return e})}(function(e,t,r){mc(e,t,r)}),xc=Qu("mergeAll",yc);xc.placeholder=ir;var bc,_c,wc,Ic=xc,kc=sc(Ic,nc(function(n){var e;return(e={})["SET_PROPERTY_"+n.toUpperCase()]=function(e,t){var r;return Mt({},e,((r={})[n]=t.data,r))},e["REMOVE_PROPERTY_"+n.toUpperCase()]=function(e){return Mt({},Nt([n],e))},e}),uc)(Ut),Ac=sc(Ic,nc(function(t){var e;return(e={})["getProperty"+Dt(t)]=function(e){return e[t]},e}),uc)(Ut),Ec=function(e){return e.environment},Rc=((bc={})[Qt.getActionName()]=function(e,t){return yt({},e,{visitorData:t.visitorData})},bc),Tc=function(e){return e.visitorData},Pc=(_c={},(wc=yt({},Rc,kc))[void 0]&&console.warn("Reducer contains an 'undefined' action type.\nHave you misspelled a constant?"),function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:_c,t=arguments[1];return wc.hasOwnProperty(t.type)?wc[t.type](e,t.payload):e}),Sc="runSaga(storeInterface, saga, ...args): saga argument must be a Generator function!";function Oc(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.context,o=void 0===t?{}:t,i=function(e,t){var r={};for(var n in e)t.indexOf(n)<0&&Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(e,["context"]),u=i.sagaMonitor,c=i.logger,s=i.onError;if(q.func(i))throw Error("Saga middleware no longer accept Generator functions. Use sagaMiddleware.run instead");if(c&&!q.func(c))throw Error("`options.logger` passed to the Saga middleware is not a function!");if(s&&!q.func(s))throw Error("`options.onError` passed to the Saga middleware is not a function!");if(i.emitter&&!q.func(i.emitter))throw Error("`options.emitter` passed to the Saga middleware is not a function!");function f(e){var a,t=e.getState,r=e.dispatch,n=(a=[],{subscribe:function(e){return a.push(e),function(){return z(a,e)}},emit:function(e){for(var t=a.slice(),r=0,n=t.length;r<n;r++)t[r](e)}});return n.emit=(i.emitter||p)(n.emit),f.run=function(e,t){for(var r=arguments.length,n=Array(2<r?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var o=void 0;q.iterator(e)?(o=e,e=t):(k(t,q.func,Sc),k(o=t.apply(void 0,n),q.iterator,Sc));var i=e.subscribe,u=e.dispatch,c=e.getState,s=e.context,f=e.sagaMonitor,p=e.logger,l=e.onError,d=Y();f&&(f.effectTriggered=f.effectTriggered||B,f.effectResolved=f.effectResolved||B,f.effectRejected=f.effectRejected||B,f.effectCancelled=f.effectCancelled||B,f.actionDispatched=f.actionDispatched||B,f.effectTriggered({effectId:d,root:!0,parentEffectId:0,effect:{root:!0,saga:t,args:n}}));var v=Ue(o,i,h(u),c,s,{sagaMonitor:f,logger:p,onError:l},d,t.name);return f&&f.effectResolved(d,v),v}.bind(null,{context:o,subscribe:n.subscribe,dispatch:r,getState:t,sagaMonitor:u,logger:c,onError:s}),function(r){return function(e){u&&u.actionDispatched&&u.actionDispatched(e);var t=r(e);return n.emit(e),t}}}return f.run=function(){throw Error("Before running a Saga, you must mount the Saga middleware on the Store using applyMiddleware")},f.setContext=function(e){k(e,q.object,X("sagaMiddleware",e)),V.assign(o,e)},f}var Cc=function(e,t){var r=Oc({context:{external:t.external}}),n=pt(function(){for(var e=arguments.length,c=Array(e),t=0;t<e;t++)c[t]=arguments[t];return function(u){return function(e,t,r){var n,a=u(e,t,r),o=a.dispatch,i={getState:a.getState,dispatch:function(e){return o(e)}};return n=c.map(function(e){return e(i)}),o=pt.apply(void 0,n)(a.dispatch),lt({},a,{dispatch:o})}}}(r),window.devToolsExtension?window.devToolsExtension():function(e){return e})(ft)(Pc,e);return n.runSaga=r.run,n},jc=Lt("PUBLIC_SEND_MESSAGE",function(e){return{customId:e.customId+"",text:e.text,promise:e.promise}}),Nc=(Lt("PUBLIC_INIT",function(e){return{license:e.license,group:e.group}}),Lt("PUBLIC_SET_VISITOR_DATA",function(e){return{name:e.name,email:e.email,customProperties:e.customProperties,pageUrl:e.pageUrl,pageTitle:e.pageTitle,promise:e.promise}})),Mc=Lt("GET_VISITOR_DATA",function(e){return{promise:e.promise}}),Lc=(Lt("PUBLIC_CALLBACK_ERROR",function(e){return{errorMessage:e.errorMessage}}),Lt("PUBLIC_RATE_CHAT",function(e){return{rate:e.rate,comment:e.comment,promise:e.promise}})),Dc=Lt("PUBLIC_SET_SNEAK_PEEK",function(e){return{text:e.text,promise:e.promise}}),Fc=Lt("PUBLIC_FORWARD_CHAT_TRANSCRIPT",function(e){return{email:e.email,promise:e.promise}}),Uc=Lt("PUBLIC_CLOSE_CHAT",function(e){return{promise:e.promise}}),Wc=Lt("PUBLIC_DISCONNECT",function(e){return{promise:e.promise}}),Gc=Lt("PUBLIC_GET_TICKET_FORM",function(e){return{promise:e.promise,group:e.group}}),Bc=Lt("PUBLIC_SEND_TICKET_FORM",function(e){return{answers:e.answers,promise:e.promise}}),qc=Lt("PUBLIC_SEND_FILE",function(e){return{file:e.file,customId:e.customId,promise:e.promise,onProgress:e.onProgress}}),Vc=Lt("PUBLIC_SEND_FILE",function(e){return{customId:e.customId}}),zc=Lt("PUBLIC_GET_PRECHAT_FORM",function(e){return{promise:e.promise}}),Hc=Lt("PUBLIC_SEND_PRECHAT_FORM",function(e){return{promise:e.promise,answers:e.answers}}),Kc=Lt("PUBLIC_GET_TRANSLATIONS",function(e){return{promise:e.promise}}),Yc=Lt("PUBLIC_GET_PREDICTED_AGENT",function(e){return{promise:e.promise}}),$c=Lt("PUBLIC_GET_POSTCHAT_FORM",function(e){return{promise:e.promise}}),Jc=Lt("PUBLIC_SEND_POSTCHAT_FORM",function(e){return{promise:e.promise,answers:e.answers}}),Qc=Lt("PUBLIC_GET_CONFIG",function(e){return{promise:e.promise}}),Zc=Lt("PUBLIC_ACCEPT_INVITATION",function(e){return{promise:e.promise,id:e.id}}),Xc=Lt("PUBLIC_MESSAGE_AS_SEEN",function(e){return{promise:e.promise,messageId:e.messageId}}),es=Lt("PUBLIC_START_CHAT",function(e){return{promise:e.promise}}),ts=Lt("PUBLIC_CHECK_GROUP_STATUS",function(e){return{group:e.group,promise:e.promise}}),rs=Lt("PUBLIC_SET_VISITOR_GROUP",function(e){return{group:e.group}}),ns=as;function as(e){this.ms=(e=e||{}).min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}as.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},as.prototype.reset=function(){this.attempts=0},as.prototype.setMin=function(e){this.ms=e},as.prototype.setMax=function(e){this.max=e},as.prototype.setJitter=function(e){this.jitter=e};var os=regeneratorRuntime.mark(function(t,r,n){for(var e=arguments.length,a=Array(3<e?e-3:0),o=3;o<e;o++)a[o-3]=arguments[o];var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=new ns({min:t,max:r});case 1:return e.prev=1,e.next=4,be.apply(void 0,[n].concat(a));case 4:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(1),e.next=12,be(l,i.duration());case 12:e.next=1;break;case 14:case"end":return e.stop()}},os,this,[[1,8]])}),is=regeneratorRuntime.mark(cs),us=regeneratorRuntime.mark(function(t){var r,n,a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,n=Array(1<(r=o.length)?r-1:0),a=1;a<r;a++)n[a-1]=o[a];return e.next=4,be.apply(void 0,[t].concat(n));case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}},us,this,[[0,7]])});function cs(t){for(var e=arguments.length,r=Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae.apply(void 0,[t].concat(r));case 2:if(void 0===(a=e.sent)){e.next=5;break}return e.abrupt("return",a);case 5:return e.next=7,me("*");case 7:e.next=0;break;case 8:case"end":return e.stop()}},is,this)}var ss=function(t){return _e(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",null);case 9:case"end":return e.stop()}},e,this,[[0,6]])}))},fs="__test_storage_support__",ps=function(){var r=Object.defineProperties({},{getItem:{value:function(e){return r[e]||null}},setItem:{value:function(e,t){try{r[e]=t+""}catch(e){}}},removeItem:{value:function(e){delete r[e]}},clear:{value:function(){Object.keys(r).forEach(r.removeItem)}},key:{value:function(e){return Object.keys(r)[e]||null}},length:{get:function(){return Object.keys(r).length}}});return r}(),ls="",ds=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"local";try{var t=window[e+"Storage"];return t.setItem(fs,!0),t.getItem(fs),t.removeItem(fs),!0}catch(e){return!1}}()?window.localStorage:ps,vs={setItem:function(e,t){ds.setItem(ls+e,t)},getItem:function(e){return ds.getItem(ls+e)},removeItem:function(e){ds.removeItem(ls+e)},setPrefix:function(e){ls=e},removeOldSecretTokenCookie:function(e){GLOBAL.cookie="secret_token_"+e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/licence/"+e+"/v2;domain=.livechatinc.com",GLOBAL.cookie="secret_token_"+e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/licence/"+e+";domain=.livechatinc.com"}};var ms=Qu("fromPairs",function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var a=e[t];n[a[0]]=a[1]}return n});ms.placeholder=ir;var hs=ms;var gs=function(e,t,r){var n=-1,a=e.length;t<0&&(t=a<-t?0:a+t),(r=a<r?a:r)<0&&(r+=a),a=r<t?0:r-t>>>0,t>>>=0;for(var o=Array(a);++n<a;)o[n]=e[n+t];return o};var ys=function(e,t,r){var n=e.length;return r=void 0===r?n:r,t||r<n?gs(e,t,r):e},xs=/[\u200d\ud800-\udfff\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff\ufe0e\ufe0f]/;var bs=function(e){return xs.test(e)};var _s=function(e){return sn(e)&&"[object RegExp]"==Ar(e)},ws=Oa&&Oa.isRegExp,Is=ws?Sa(ws):_s;var ks=function(e){return e.split("")},As="\\ud800-\\udfff",Es="["+As+"]",Rs="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Ts="\\ud83c[\\udffb-\\udfff]",Ps="[^"+As+"]",Ss="(?:\\ud83c[\\udde6-\\uddff]){2}",Os="[\\ud800-\\udbff][\\udc00-\\udfff]",Cs="(?:"+Rs+"|"+Ts+")"+"?",js="[\\ufe0e\\ufe0f]?",Ns=js+Cs+("(?:\\u200d(?:"+[Ps,Ss,Os].join("|")+")"+js+Cs+")*"),Ms=RegExp(Ts+"(?="+Ts+")|"+("(?:"+[Ps+Rs+"?",Rs,Ss,Os,Es].join("|")+")")+Ns,"g");var Ls=function(e){return e.match(Ms)||[]};var Ds=function(e){return bs(e)?Ls(e):ks(e)};var Fs=Qu("split",function(e,t,r){return r&&"number"!=typeof r&&gc(e,t,r)&&(t=r=void 0),(r=void 0===r?4294967295:r>>>0)?(e=Ru(e))&&("string"==typeof t||null!=t&&!Is(t))&&!(t=Eu(t))&&bs(e)?ys(Ds(e),0,r):e.split(t,r):[]});Fs.placeholder=ir;var Us=Fs,Ws=hc(function(e,t){var r=qn(t,Dn(Ws));return la(e,64,void 0,t,r)});Ws.placeholder={};var Gs=Qu("partialRight",Ws);Gs.placeholder=ir;var Bs=Gs;var qs=function(e,t){for(var r=-1,n=e.length;++r<n&&-1<On(t,e[r],0););return r},Vs=/^\s+/;var zs=Qu("trimStart",function(e,t,r){if((e=Ru(e))&&(r||void 0===t))return e.replace(Vs,"");if(!e||!(t=Eu(t)))return e;var n=Ds(e),a=qs(n,Ds(t));return ys(n,a).join("")});zs.placeholder=ir;var Hs=zs,Ks=function(e){return(t=e,Object.keys(t).map(function(e){return[e,t[e]]})).map(function(e){return e.map(encodeURIComponent).join("=")}).join("&");var t},Ys=/^((http(s)?\:)?\/\/)/,$s=function(e){return e.replace(Ys,"")};function Js(e){return-1!==e.indexOf("cdn.livechatinc.com/cloud/?uri")?"https://"+$s(e):"https://cdn.livechatinc.com/cloud/?uri=http://"+encodeURI($s(e))}function Qs(e){var t=e.agent;return{invitation:{id:e.unique_id,authorId:t.login,text:e.greeting_message.text,receivedFirstTime:e.displayed_first_time},agent:{avatarUrl:Js(t.avatar_url),jobTitle:t.job_title,name:t.name,id:t.login}}}var Zs=function(e,n,t){var a;return t(e,function(e,t,r){if(n(e,t,r))return a=t,!1}),a};var Xs=Qu("findKey",function(e,t){return Zs(e,Uu(t,3),Xu)});Xs.placeholder=ir;var ef,tf,rf=Xs,nf=function(e,t){return e.order-t.order},af={question:{type:"text"},checkbox_for_email:{type:"checkbox",meta:"confirm_subscription"},header:{type:"information"},skill:{type:"group_select"}},of=function(e){return e.map(function(e,t){var r={};return It("label",e)&&(r.label=e.label),It("checked",e)&&(r.checked=e.checked),r.value=t+"",It("skill_id",e)&&(r.value=e.skill_id+""),r})},uf=function(e){var u=!1,t={fields:e.fields.sort(nf).map(function(e,t){var r,n={};if("facebookConnect"===e.type)return!(u=!0);e.id?n.name=e.id:-1===["header","information"].indexOf(e.type)&&(n.name=t+""),e.value&&(n.value=e.value),It("label",e)&&(n.label=e.label),It("required",e)&&(n.required=e.required),e.skills&&0<e.skills.length?n.options=of(e.skills):e.options&&0<e.options.length&&(e.options_data?n.options=of(e.options_data):n.options="object"!==(void 0===(r=e.options[0])?"undefined":At(r))||null===r||kt(r)?e.options.map(function(e,t){return{label:e,value:t+""}}):e.options.map(function(e,t){return{label:e.label,value:t+""}}));var a,o={type:af[a=e.type]&&af[a].type||a,meta:af[a]&&af[a].meta||!1},i=o.meta;return n.type=o.type,i&&(n.meta=i),n}).filter(Boolean)};return e.id&&(t.id=e.id),u&&(t.facebookConnect=!0),t},cf=function(e){return yt({},e,{fields:e.fields.map(function(e){return"email"===e.type||"textarea"===e.type?yt({},e,{required:!0}):e})})},sf=function(o,t){var e={survey_id:t.id},r=["name","question","email","checkbox","checkbox_for_email","radio","skill","select","textarea"],n=t.fields.map(function(n,e){var a={id:n.name,order:t.facebookConnect?e+1:e,type:function(r){var n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return rf(function(e){var t=e.meta;return e.type===r&&(!t||n===t)},af)||r}(n.type,n.meta)};return It("label",n)&&(a.label=n.label),It("options",n)?a.answers=n.options.map(function(e,t){var r={index:t};return It("label",e)&&(r.label=e.label),"skill"===a.type&&(r.group_id=parseInt(e.value,10)),r.chosen=o[n.name]&&(Array.isArray(o[n.name])&&-1!==o[n.name].indexOf(e.value)||"string"==typeof o[n.name]&&o[n.name]===e.value)||!1,r}):a.answer=o[n.name]||"",a}).filter(function(e){return-1!==r.indexOf(e.type)});return e.fields=n,e},ff="function"==typeof fetch?fetch:function(a,o){return o=o||{},new Promise(function(e,t){var r=new XMLHttpRequest;for(var n in r.open(o.method||"get",a),o.headers)r.setRequestHeader(n,o.headers[n]);function u(){var n,a=[],o=[],i={};return r.getAllResponseHeaders().replace(/^(.*?):\s*([\s\S]*?)$/gm,function(e,t,r){a.push(t=t.toLowerCase()),o.push([t,r]),i[t]=(n=i[t])?n+","+r:r}),{ok:1==(r.status/200|0),status:r.status,statusText:r.statusText,url:r.responseURL,clone:u,text:function(){return Promise.resolve(r.responseText)},json:function(){return Promise.resolve(r.responseText).then(JSON.parse)},xml:function(){return Promise.resolve(r.responseXML)},blob:function(){return Promise.resolve(new Blob([r.response]))},headers:{keys:function(){return a},entries:function(){return o},get:function(e){return i[e.toLowerCase()]},has:function(e){return e.toLowerCase()in i}}}}r.withCredentials="include"==o.credentials,r.onload=function(){e(u())},r.onerror=t,r.send(o.body)})},pf=function(i,u){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},s=new XMLHttpRequest,r=new Promise(function(e,r){var t,n,a=c.headers,o=c.onProgress;"function"==typeof o&&(s.upload.onprogress=function(e){o(e.loaded/e.total)}),s.onload=function(){var t=void 0;try{t=JSON.parse(s.response)}catch(e){t=s.response}s.status<200||300<=s.status?r(t):e(t)},s.onerror=function(e){r(e)},s.onabort=function(){r({code:"CANCELLED"})},s.open(c.method||"POST",i),s.withCredentials=c.withCredentials,a&&Object.keys(a).forEach(function(e){return s.setRequestHeader(e,a[e])}),s.send((t=u,n=new FormData,Object.keys(t).forEach(function(e){return n.append(e,t[e])}),n))});return{then:function(e,t){return r.then(e,t)},catch:function(e){return r.catch(e)},cancel:function(){s.abort()}}},lf="production",df="staging",vf="labs",mf=((ef={})[vf]="-labs.",ef[df]="-lc.",ef[lf]=".",ef),hf=((tf={})[vf]="labs.",tf[df]="staging.",tf[lf]="",tf),gf=function(e,t,r){var n=t;return 1520===r&&(n=df),"https://secure"+(e?"-"+e:"")+mf[n]+"livechatinc.com"},yf=function(e,t,r){var n=t;return 1520===r&&(n=df),"https://api"+(e?"-"+e:"")+"."+hf[n]+"livechatinc.com"},xf=function(e,a){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=t.attempts||3,i=t.retryDelay||1e3;return new Promise(function(r,n){!function t(){ff(e,a).then(function(e){return r(e)}).catch(function(e){return o?(--o,setTimeout(function(){t()},i)):n(e)})}()})},bf=function(e){var t=e.license,r=e.token,n=e.file,a=e.chatId,o=e.onProgress,i=yf(e.region,e.environment,t)+"/v2/chats/"+a+"/attachment",u=pf(i,{"author[type]":"visitor",license_id:t,files:n,token:r},{onProgress:o});return u[w]=u.cancel,u},_f=function(e,t,r){var n=t.body,a=yf(t.region,t.environment,t.license)+"/"+e;return xf(a,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)},r).then(function(e){return e.json()})},wf=function(e,t){var r=""+gf(t.region,t.environment,t.license)+e;return xf(r,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(e){return e.json()})},If=["ping","status_ping","start_chat","close_chat","agent_message_seen","send_rating_comment","post_chat_survey_data","get_predicted_agent","attachment_token"],kf=function(e,t,r,n){return!1===t?"licence/g"+e+"_"+n:r?"licence/external/"+e:"licence/"+e},Af=function(e,t,r){var n=t.environment,a=t.license,o=t.body,i=void 0===o?{}:o,u=t.securedToken,c=t.secretId,s=t.region,f=t.queryStringData,p=void 0===f?{}:f,l=t.external,d=t.chatBetweenGroups,v=t.group,m=-1!==If.indexOf(e)||-1!==e.indexOf("get_static_config")?"v2/":"",h={};u&&(h.secret_token=u),c&&(h.secret_id=c);var g=gf(s,n,a)+"/"+kf(a,d,l,v)+"/"+m+e+"?"+Ks(yt({},p,h));return xf(g,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(i)},r).then(function(e){return e.json()})},Ef=function(e,t){var r=t.license,n=t.securedToken,a=t.secretId,o=t.external,i=t.group,u=t.chatBetweenGroups,c=gf(t.region,t.environment,r)+"/"+kf(r,u,o,i)+"/tunnel_callback.cgi?"+function(e){for(var t="",r="0123456789abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ",n=0;n<e;n++)t+=r.substr(Math.floor(64*Math.random()),1);return t}(20);return n&&(c+="&secret_token="+n),a&&(c+="&secret_id="+a),xf(c+="&command="+encodeURI(e),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(e){return e.text()}).then(function(e){return e.split("^")})},Rf=regeneratorRuntime.mark(Pf),Tf=regeneratorRuntime.mark(Sf);function Pf(t,r){var n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyChatBetweenGroups);case 2:return n=e.sent,e.next=5,Ae(Ac.getPropertyGroup);case 5:return a=e.sent,"get_dynamic_config.js",e.t0=be,e.t1=Af,e.t2="get_dynamic_config.js",e.t3=_t,e.t4={},e.t5=t,e.t6=r,e.next=16,Re("external");case 16:return e.t7=e.sent,e.t8={queryStringData:e.t6,external:e.t7},e.t9=e.t3.extends.call(e.t3,e.t4,e.t5,e.t8),e.next=21,(0,e.t0)(e.t1,e.t2,e.t9);case 21:if(!(o=e.sent).error||"incorrect region"!==o.error){e.next=40;break}return e.next=25,he(Wt.setPropertyRegion(o.region));case 25:return e.t10=be,e.t11=Pf,e.t12=_t,e.t13={},e.t14=t,e.t15=o.region,e.next=33,Re("external");case 33:return e.t16=e.sent,e.t17={region:e.t15,external:e.t16},e.t18=e.t12.extends.call(e.t12,e.t13,e.t14,e.t17),e.next=38,(0,e.t10)(e.t11,e.t18);case 38:return e.abrupt("return",e.sent);case 40:if(!1!==n||o.visitor.groups===a){e.next=57;break}return e.next=43,he(Wt.setPropertyGroup(o.visitor.groups));case 43:return e.t19=be,e.t20=Pf,e.t21=_t,e.t22={},e.t23=t,e.next=50,Re("external");case 50:return e.t24=e.sent,e.t25={external:e.t24},e.t26=e.t21.extends.call(e.t21,e.t22,e.t23,e.t25),e.next=55,(0,e.t19)(e.t20,e.t26);case 55:return e.abrupt("return",e.sent);case 57:return e.abrupt("return",o);case 58:case"end":return e.stop()}},Rf,this)}function Sf(){var t,r,n,a,o,i,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyLicense);case 2:return t=e.sent,e.next=5,Ae(Ac.getPropertyGroup);case 5:return r=e.sent,e.next=8,Ae(Ec);case 8:return n=e.sent,e.next=11,Ae(Ac.getPropertyRegion);case 11:return a=e.sent,e.next=14,Ae(Tc);case 14:return o=e.sent,e.next=17,Ae(Ac.getPropertyChatBetweenGroups);case 17:return i=e.sent,u={},o.pageUrl&&(u.url=o.pageUrl),void 0!==r&&(u.groups=r),e.next=23,be(Pf,{environment:n,license:t,group:r,region:a,chatBetweenGroups:i},u);case 23:return e.abrupt("return",e.sent);case 24:case"end":return e.stop()}},Tf,this)}var Of=Qu("identity",lr,oc);Of.placeholder=ir;var Cf,jf=Of,Nf=function(e){return"1"===e},Mf=function(e){return e.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&#94;/g,"^").replace(/&#45;/g,"-").replace(/&amp;/g,"&").replace(/<BR>/g,"\n")},Lf=Mf,Df=function(e){return JSON.parse(Mf(e))},Ff=((Cf={}).none="0",Cf.bad="1",Cf.good="2",Cf),Uf={NEW_AGENT:"newAgent",NEW_AGENT_MESSAGE:"newAgentMessage",CHAT_ENDED:"chatEnded",VISITOR_QUEUED:"visitorQueued",TYPING_INDICATOR:"typingIndicator",RATE_CHAT:"rateChat",FORWARD_CHAT_TRANSCRIPT:"forwardChatTranscript",AGENTS_OFFLINE:"agentsOffline",GET_FORM:"getForm",GET_TICKET_FORM:"getTicketForm",JSON:"JSON"},Wf={IWCS5012F:[Uf.AGENTS_OFFLINE,{}],IWCS5011F:[Uf.AGENTS_OFFLINE,{}],IWCS0002R:[Uf.NEW_AGENT,{1:["id"],2:["name"],12:["chatId"],23:["avatarUrl"],25:["jobTitle"]}],IWCS0006R:[Uf.NEW_AGENT_MESSAGE,{1:["authorId"],2:["message",Lf],9:["isMobile",Nf],10:["id"]}],IWCS1007S:[Uf.CHAT_ENDED,null],IWCS1002S:[Uf.VISITOR_QUEUED,{2:["numberInQueue",parseInt],3:["waitingTime",parseInt]}],IWCS0002P:[Uf.TYPING_INDICATOR,{2:["realCommand",function(e){var t=e.split("&#45;");return{authorId:t[1],isTyping:Nf(t[2])}}]}],IWCS0113C:[Uf.RATE_CHAT,{1:["visitorId"],2:["chatId"],3:["rate",function(t){return Tt(function(e){return Ff[e]===t},Object.keys(Ff))},function(e){return Ff[e]}]}],IWCS0069C:[Uf.FORWARD_CHAT_TRANSCRIPT,{1:["visitorId"],2:["email"],5:["chatId"]}],IWCS0121C:[Uf.GET_FORM,{1:["type",null,function(){return"1"}],2:["license"],4:["group"]}],IWCS0122C:[Uf.GET_TICKET_FORM,{1:["license"],2:["offline",null,function(){return"offline"}],3:["group"]}],IWCSJSON:[Uf.JSON,{1:["json",Df]}]},Gf=function(e){var t=e.split("^"),r=t[0],n=t.slice(1),a=Wf[r];if(!a)return null;var u=a[1];return{name:a[0],data:n.reduce(function(e,t,r){if(!u||!u[r+1])return e;var n=u[r+1],a=n[0],o=n[1],i=void 0===o?jf:o;return"realCommand"===a?yt({},e,i(t)):(e[a]=i(t),e)},{})}},Bf=function(t,e){for(var r,n=rf(function(e){return e[0]===t},Wf),a=Wf[n][1],o=Math.max.apply(Math,Object.keys(a)),i=[n];i.length<o+1;){var u=a[i.length];if(u){var c=(r=e[u[0]]+"",r.replace(/[\x01-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"")).replace(/\^/g,"&#94;");i.push(u[2]?u[2](c):c)}else i.push("")}return i.join("^")+"^"},qf=regeneratorRuntime.mark(Yf),Vf=regeneratorRuntime.mark($f),zf=regeneratorRuntime.mark(Jf),Hf=regeneratorRuntime.mark(Qf),Kf=regeneratorRuntime.mark(Zf);function Yf(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge({license:Ae(Ac.getPropertyLicense),securedToken:Ae(Ac.getPropertySecuredToken),secretId:Ae(Ac.getPropertySecretId),environment:Ae(Ec),region:Ae(Ac.getPropertyRegion),external:Re("external"),group:Ae(Ac.getPropertyGroup),chatBetweenGroups:Ae(Ac.getPropertyChatBetweenGroups)});case 2:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},qf,this)}function $f(t,r){var n,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(Yf);case 2:return n=e.sent,e.next=5,be(Af,t,yt({},n,{body:r}),a);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},Vf,this)}function Jf(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(Yf);case 2:return r=e.sent,e.next=5,be(wf,t,r);case 5:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},zf,this)}function Qf(t,r){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=Bf(t,r),e.next=3,be(Yf);case 3:return a=e.sent,e.next=6,be(Ef,n,a);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},Hf,this)}function Zf(t,r){var n,a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(Yf);case 2:return a=(n=e.sent).license,o=n.environment,i=n.region,e.next=6,be(_f,t,{environment:o,region:i,license:a,body:r});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},Kf,this)}var Xf=regeneratorRuntime.mark(ep);function ep(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={},e.next=3,be($f,"get_static_config."+t+"."+r+".js",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},Xf,this)}var tp=regeneratorRuntime.mark(pp),rp=regeneratorRuntime.mark(lp),np=regeneratorRuntime.mark(dp),ap=regeneratorRuntime.mark(vp),op=regeneratorRuntime.mark(mp),ip=regeneratorRuntime.mark(hp),up=regeneratorRuntime.mark(gp),cp=regeneratorRuntime.mark(yp),sp=sc(hs,nc(sc(nc(decodeURIComponent),Us("="))),Us("&"),Bs(Hs.convert({fixed:!1}),["?"])),fp=function(e){var t,r,n,a={visitorData:jt(Rt,e.visitor),features:{fileSharing:{enabled:e.attachments.enable_for_visitors},agentAvatar:{enabled:e.chat_window.display_avatar,showWithMessage:e.chat_window.display_avatar&&"modern"!==Ot("group_properties.chat_window.new_theme.name",e)},rating:{enabled:e.chat_window.display_rating,position:"modern"===Ot("group_properties.chat_window.new_theme.name",e)?"bottom":"right"},emailTranscript:{enabled:e.chat_window.display_transcript_button},logo:{enabled:e.chat_window.logo.display,path:Js(e.chat_window.logo.path)},facebookButton:{enabled:!!e.chat_window.social.facebook},twitterButton:{enabled:!!e.chat_window.social.twitter},googlePlusButton:{enabled:!!e.chat_window.social.plusone},offlineForm:{enabled:!e.embedded_chat.hide_when_offline},linksPreview:{enabled:"1"===e.group_properties.links_unfurling},preChatForm:{enabled:e.pre_chat_survey&&e.pre_chat_survey.enabled||!1},preChatAfterGreeting:{enabled:"1"===e.group_properties.pre_chat_survey_after_greeting},creditCardMasking:{enabled:e.mask_credit_cards},hideTrademark:{enabled:"1"===e.group_properties.chat_window.hide_trademark},hideOnMobile:{enabled:"1"===e.group_properties.chat_window.hide_on_mobile},hideOnInit:{enabled:"1"===e.group_properties.chat_window.hide_on_init},disableSounds:{enabled:"1"===e.group_properties.chat_window.disable_sounds}},buttons:e.buttons.map(function(e){return{id:e.id,type:e.type,onlineImage:Js(e.online_value),offlineImage:Js(e.offline_value)}}),theme:{color:e.chat_window.theme.color,name:e.chat_window.theme.name,minimized:e.group_properties.chat_window.theme.minimized},newTheme:{name:e.group_properties.chat_window.new_theme.name,iconTheme:"modern"===e.group_properties.chat_window.new_theme.name?"modern":"smooth",agentMessageBackgroundColor:Ct("#fffff","group_properties.chat_window.new_theme.agent_message_color_background",e),agentMessageColorText:Ct("#424d57","group_properties.chat_window.new_theme.agent_message_color_text",e),backgroundColor:Ct("#e9eef4","group_properties.chat_window.new_theme.background_color",e),minimizedColorBackground:Ct("#ffffff","group_properties.chat_window.new_theme.minimized_color_background",e),minimizedColorIcon:Ct("#4384F5","group_properties.chat_window.new_theme.minimized_color_icon",e),minimizedColorText:Ct("#000000","group_properties.chat_window.new_theme.minimized_color_text",e),visitorMessageBackgroundColor:Ct("#4384f5","group_properties.chat_window.new_theme.visitor_message_color_background",e),visitorMessageColorText:Ct("#ffffff","group_properties.chat_window.new_theme.visitor_message_color_text",e),titlebarBackgroundColor:Ct("#ffffff","group_properties.chat_window.new_theme.titlebar_background_color",e),titlebarText:Ct("#424d57","group_properties.chat_window.new_theme.titlebar_text",e),systemMessageColor:Ct("#424d57","group_properties.chat_window.new_theme.system_message_color",e),customJson:function(e){var t={};try{t=JSON.parse(e)}catch(e){}return t}(Ot("group_properties.chat_window.new_theme.custom_json",e))},domainWhitelist:e.domain_whitelist,widgetType:e.embedded_chat.enabled?"embedded":"popup",integrations:e.integrations,language:e.lang,groups:(t=e.skills,r=e.skills_online,n="id",t.map(function(e){return{id:e.id,status:-1!==r.indexOf(e.id)?"online":"offline",oldButtons:{onlineImage:Js(e.chat_button.online_url),offlineImage:Js(e.chat_button.offline_url)}}}).reduce(function(e,t){return e[t[n]]=t,e},{})),clientLimitExceeded:e.client_limit_exceeded,screenPosition:e.group_properties.chat_window.screen_position};return a.features.facebookButton.enabled&&(a.features.facebookButton.path=e.chat_window.social.facebook),a.features.twitterButton.enabled&&(a.features.facebookButton.path=e.chat_window.social.twitter),a.features.googlePlusButton.enabled&&(a.features.facebookButton.path=e.chat_window.social.plusone),a};function pp(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(Wt.setPropertyTicketForm(cf(uf(t.offline_form))));case 2:return e.next=4,Re("external");case 4:if(r=e.sent,!t.pre_chat_survey){e.next=9;break}return n=uf(t.pre_chat_survey),e.next=9,he(Wt.setPropertyPreChatForm(n));case 9:return a=r?t.localization_url.replace("/licence/","/licence/external/"):t.localization_url,e.next=12,he(Wt.setPropertyTranslationsVersion(a));case 12:case"end":return e.stop()}},tp,this)}function lp(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=fp(t),e.next=3,Ae(Ac.getPropertyGroup);case 3:if(-1===t.skills_online.indexOf(e.sent)){e.next=9;break}return e.next=7,he(Wt.setPropertyChatStatus("ONLINE"));case 7:e.next=11;break;case 9:return e.next=11,he(Wt.setPropertyChatStatus("OFFLINE"));case 11:return e.next=13,he(Wt.setPropertyConfig(r));case 13:case"end":return e.stop()}},rp,this)}function dp(){var t,r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyStaticConfigVersion);case 2:return t=e.sent,e.next=5,Ae(Ac.getPropertyGroup);case 5:return r=e.sent,e.next=8,be(ep,r,t);case 8:return n=e.sent,e.next=11,be(pp,n);case 11:return e.next=13,Ae(Ac.getPropertyDynamicConfig);case 13:return a=yt({},e.sent,n),e.next=17,be(lp,a);case 17:case"end":return e.stop()}},np,this)}function vp(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyTranslationsVersion);case 2:if(t=e.sent){e.next=9;break}return e.next=6,be(dp);case 6:return e.next=8,be(cs,Ac.getPropertyTranslationsVersion);case 8:t=e.sent;case 9:return e.next=11,be(Jf,t);case 11:return r=jt(function(e){return e.toLowerCase()},e.sent.localization),e.next=15,he(Wt.setPropertyTranslations(r));case 15:case"end":return e.stop()}},ap,this)}function mp(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Tc);case 2:return r=e.sent,e.next=5,Ae(Ac.getPropertyVisitorId);case 5:if(n=e.sent,a=yt({},r),void 0===t.visitor.groups){e.next=10;break}return e.next=10,he(Wt.setPropertyGroup(t.visitor.groups));case 10:return e.next=12,he(Wt.setPropertyStaticConfigVersion(t.static_config_version));case 12:if((r.name||t.visitor.nick)&&(a.name=r.name||t.visitor.nick),t.visitor.params&&(a.customProperties=yt({},a.customParams,sp(t.visitor.params))),!t.visitor.nick&&!t.visitor.params){e.next=17;break}return e.next=17,he(Qt({visitorData:a}));case 17:if(n){e.next=21;break}return e.next=20,he(Wt.setPropertyVisitorId(t.visitor.session));case 20:vs.setItem("visitorId",t.visitor.session);case 21:return e.next=23,he(Wt.setPropertyConfigLoaded(!0));case 23:case"end":return e.stop()}},op,this)}function hp(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(mp,t);case 2:return e.next=4,he(Wt.setPropertyDynamicConfig(t));case 4:return e.next=6,he(Wt.setPropertyClientLimitExceeded(t.client_limit_exceeded));case 6:if(!t.automatic_greeting){e.next=12;break}return r=Qs(t.automatic_greeting),n=r.agent,a=r.invitation,e.next=10,he(Vt(n));case 10:return e.next=12,he(tr(a));case 12:case"end":return e.stop()}},ip,this)}function gp(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(Sf);case 2:return r=(t=e.sent).static_config_version,n=t.visitor.groups,e.next=7,be(ep,n,r);case 7:if("3"!==e.sent.license_properties.lc_version){e.next=12;break}return e.next=12,he(nr());case 12:case"end":return e.stop()}},up,this)}function yp(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,be(hp,t);case 3:return e.next=5,be(pp,t);case 5:return e.next=7,be(lp,t);case 7:return e.abrupt("return");case 8:return e.next=10,be(Sf);case 10:return r=e.sent,e.next=13,be(hp,r);case 13:case"end":return e.stop()}},cp,this)}var xp="CHATTING",bp="NOT_CHATTING",_p=regeneratorRuntime.mark(wp);function wp(e){var t,r,n,a,o,i,u=e.customId,c=e.text,s=e.answers,f=e.welcomeMessage,p=e.acceptedInvitation,l=e.fromManualInvitation,d=void 0!==l&&l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyGroup);case 2:return t=e.sent,e.next=5,be(cs,Ac.getPropertyVisitorId);case 5:return r=e.sent,e.next=8,Ae(Tc);case 8:return n=e.sent,e.next=11,be(cs,Ac.getPropertyPingSent);case 11:return a={group:t,source_group:t,details:"",details_labels:"",from_manual_invitation:d,integration_params:"",random_id:u,trigger_unique_id:"",version:"Embedded",custom_variables:{},is_mobile:!1,welcome_message:f||"",return_secured_session_id:!0,visitor:{id:r,nick:n.name||"Client",email:n.email||""},script_version:{embedded_env:"production",embedded_version:"VisitorSDK-0.35.2"}},c&&(a.visitor_message=c,a.visitor_message_id=u),n.customProperties&&(a.custom_variables=Et(String,n.customProperties)),s&&(a.pre_chat_survey=s),p&&(a.trigger_unique_id=p),e.next=18,he(Wt.setPropertyChatId(void 0));case 18:return e.next=20,Ae(Ac.getPropertyLicense);case 20:return o=e.sent,vs.removeItem("securedToken"),vs.removeOldSecretTokenCookie(o),e.next=25,he(Wt.removePropertySecuredToken());case 25:return e.next=27,he(Wt.setPropertyServerIdsMap({}));case 27:return e.next=29,he(Wt.setPropertyVisitorCustomIdMap({}));case 29:return e.next=31,be($f,"start_chat",a);case 31:if(!(i=e.sent).secured_session_id){e.next=36;break}return e.next=35,he(Wt.setPropertySecretId(i.secured_session_id));case 35:vs.setItem("secretId",i.secured_session_id);case 36:if(!i.secured_token){e.next=42;break}return e.next=39,he(Wt.setPropertySecuredToken(i.secured_token));case 39:return e.next=41,he(Wt.setPropertyChatState(xp));case 41:vs.setItem("securedToken",i.secured_token);case 42:case"end":return e.stop()}},_p,this)}var Ip=regeneratorRuntime.mark(kp);function kp(e){var t,r=e.customId,n=e.text;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:return t={author:"visitor",message:n,message_id:r,random_id:r,visitor:{id:e.sent}},e.next=6,be($f,"send_message",t);case 6:return e.next=8,he({type:"PRIVATE_SEND_MESSAGE"});case 8:case"end":return e.stop()}},Ip,this)}var Ap=regeneratorRuntime.mark(Ep);function Ep(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:return t=e.sent,r={source:"visitor",random_id:Math.random()+"",visitor:{id:t}},e.next=6,be($f,"close_chat",r);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},Ap,this)}var Rp=regeneratorRuntime.mark(Tp);function Tp(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:return r=e.sent,e.next=5,Ae(Ac.getPropertyChatId);case 5:return n={visitorId:r,chatId:e.sent,email:t.payload.email},e.next=9,be(Qf,"forwardChatTranscript",n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},Rp,this)}var Pp=regeneratorRuntime.mark(Sp);function Sp(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:return r=e.sent,e.next=5,Ae(Ac.getPropertyChatId);case 5:return n={visitorId:r,chatId:e.sent,rate:t.payload.rate},e.next=9,be(Qf,"rateChat",n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},Pp,this)}var Op=regeneratorRuntime.mark(Cp);function Cp(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyLicense);case 2:return r={license:e.sent,offline:"offline",group:t},e.next=6,be(Qf,"getTicketForm",r);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},Op,this)}var jp=regeneratorRuntime.mark(Np);function Np(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:return r=e.sent,e.next=5,Ae(Ac.getPropertyChatId);case 5:return n={comment:t.payload.comment,conference_id:e.sent,random_id:Math.random()+"",visitor:{id:r}},e.next=9,be($f,"send_rating_comment",n);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},jp,this)}var Mp=regeneratorRuntime.mark(Fp),Lp=function(e,t){var n=jt(function(e){return"message"===e?"textarea":e},e);return t.fields.map(function(e){if("information"===e.type)return null;var t,r={type:e.type,text:e.label};return(It(e.name,n)||It(e.type,n))&&(r.value=It("options",e)?(t=n[e.name],kt(t)?t:[t]).map(function(t){return Tt(function(e){return e.value===t},e.options).label}).join(", "):n[e.name]||n[e.type],r.text=r.text+" "+r.value),r}).filter(Boolean)},Dp=function(e,t,r){var n=e.group,a=e.license,o=e.visitorId,i=e.visitorData,u=Lp(r,t),c=Tt(function(e){return"email"===e.type},u);if(!c)throw{type:"missing argument",reason:"Missing email"};if(!Tt(function(e){return"textarea"===e.type},u))throw{type:"missing argument",reason:"Missing message"};var s=Tt(function(e){return"subject"===e.type},u),f=u.filter(function(e){return-1===["name","email","subject"].indexOf(e.type)}).map(function(e){return e.text}).join("\n"),p={mail:c.value},l=Tt(function(e){return"name"===e.type},u);l&&(p.name=l.value);var d={group:n,licence_id:a,ticket_message:f,offline_message:u.map(function(e){return e.text}).join("\n"),requester:p,visitor_id:o};return s&&(d.subject=s.value),i.pageUrl&&(d.source={url:i.pageUrl}),d};function Fp(t){var r,n,a,o,i,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyGroup);case 2:return r=e.sent,e.next=5,Ae(Ac.getPropertyLicense);case 5:return n=e.sent,e.next=8,be(cs,Ac.getPropertyVisitorId);case 8:return a=e.sent,e.next=11,Ae(Tc);case 11:return o=e.sent,e.next=14,Ae(Ac.getPropertyTicketForm);case 14:return i=Dp({group:r,license:n,visitorId:a,visitorData:o},e.sent,t.answers),e.next=18,be(Zf,"v2/tickets/new",i);case 18:return u={id:e.sent.id,text:i.ticket_message,visitor:{name:i.requester.name||null,email:i.requester.mail||null}},i.subject&&(u.subject=i.subject),e.abrupt("return",u);case 23:case"end":return e.stop()}},Mp,this)}var Up=regeneratorRuntime.mark(Wp);function Wp(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:return r=e.sent,n=t.customId,e.next=6,be(cs,Ac.getPropertyChatId);case 6:return a={random_id:n,conference_id:e.sent,visitor:{id:r},valid_time_sec:60},e.next=10,be($f,"attachment_token",a);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},Up,this)}var Gp=regeneratorRuntime.mark(Bp);function Bp(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyLicense);case 2:return t=e.sent,e.next=5,Ae(Ac.getPropertyGroup);case 5:return r={type:"postchat",license:t,group:e.sent},e.next=9,be(Qf,"getForm",r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},Gp,this)}var qp=regeneratorRuntime.mark(Vp);function Vp(e){var t,r,n=e.answers;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyVisitorId);case 2:return t=e.sent,e.next=5,Ae(Ac.getPropertyChatId);case 5:return r={conference_id:e.sent,random_id:Math.random()+"",survey:n,visitor:{id:t}},e.next=9,be($f,"post_chat_survey_data",r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}},qp,this)}var zp=regeneratorRuntime.mark(Hp);function Hp(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:return t=e.sent,r={random_id:Math.random()+"",visitor:{id:t}},e.next=6,be($f,"get_predicted_agent",r);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}},zp,this)}var Kp=regeneratorRuntime.mark(Yp);function Yp(e){var t,r,n,a=e.messageId;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:return t=e.sent,e.next=5,Ae(Ac.getPropertyServerIdsMap);case 5:return n={message:{id:(r=e.sent[a]).serverId,agent_id:r.authorId},random_id:Math.random()+"",visitor:{id:t}},e.next=10,be($f,"agent_message_seen",n);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}},Kp,this)}var $p=regeneratorRuntime.mark(Jp);function Jp(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t){e.next=4;break}e.t0=t,e.next=7;break;case 4:return e.next=6,Ae(Ac.getPropertyGroup);case 6:e.t0=e.sent;case 7:return r=e.t0,e.next=10,be(cs,Ac.getPropertyVisitorId);case 10:return n={visitor:{id:e.sent},skill:r,random_id:Math.random()+""},e.next=14,be($f,"status_ping",n,{retry:10});case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},$p,this)}var Qp=function(e){return{chatState:e.visitor_is_chatting?xp:bp,chatStatus:e.agent_available?"ONLINE":"OFFLINE"}},Zp=Qu("get",Ou);Zp.placeholder=ir;var Xp=Zp;var el=Qu("isNil",function(e){return null==e},oc);el.placeholder=ir;var tl=el;var rl=function(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}};var nl=function(e,t,r,n){if(!Er(e))return e;for(var a=-1,o=(t=Tu(t,e)).length,i=o-1,u=e;null!=u&&++a<o;){var c=Pu(t[a]),s=r;if(a!=i){var f=u[c];void 0===(s=n?n(f,c,u):void 0)&&(s=Er(f)?f:Un(t[a+1])?[]:{})}ga(u,c,s),u=u[c]}return e};var al=function(e,t,r){for(var n=-1,a=t.length,o={};++n<a;){var i=t[n],u=Su(e,i);r(u,i)&&nl(o,Tu(i,e),u)}return o};var ol=function(e,r){if(null==e)return{};var t=wu(qo(e),function(e){return[e]});return r=Uu(r),al(e,t,function(e,t){return r(e,t[0])})};var il=Qu("omitBy",function(e,t){return ol(e,rl(Uu(t)))});il.placeholder=ir;var ul=il,cl=Qu("merge",yc);cl.placeholder=ir;var sl=cl;var fl=function(r,e){return al(r,e,function(e,t){return Nu(r,t)})},pl=Qu("pick",Ku(function(e,t){return null==e?{}:fl(e,t)}));pl.placeholder=ir;var ll=pl,dl=regeneratorRuntime.mark(pd),vl=regeneratorRuntime.mark(ld),ml=regeneratorRuntime.mark(dd),hl=regeneratorRuntime.mark(vd),gl=regeneratorRuntime.mark(md),yl=regeneratorRuntime.mark(hd),xl=regeneratorRuntime.mark(gd),bl=regeneratorRuntime.mark(yd),_l=regeneratorRuntime.mark(xd),wl=regeneratorRuntime.mark(bd),Il=regeneratorRuntime.mark(_d),kl=regeneratorRuntime.mark(wd),Al=regeneratorRuntime.mark(Id),El=regeneratorRuntime.mark(kd),Rl=regeneratorRuntime.mark(Td),Tl=regeneratorRuntime.mark(Pd),Pl=regeneratorRuntime.mark(Sd),Sl=regeneratorRuntime.mark(Od),Ol=regeneratorRuntime.mark(Cd),Cl=regeneratorRuntime.mark(jd),jl=regeneratorRuntime.mark(Nd),Nl=regeneratorRuntime.mark(Md),Ml=regeneratorRuntime.mark(Ld),Ll=regeneratorRuntime.mark(Dd),Dl=regeneratorRuntime.mark(Fd),Fl=regeneratorRuntime.mark(Ud),Ul=regeneratorRuntime.mark(Wd),Wl=regeneratorRuntime.mark(Gd),Gl=18e5,Bl=jc,ql=Nc,Vl=Mc,zl=Lc,Hl=Dc,Kl=Fc,Yl=Uc,$l=Wc,Jl=Gc,Ql=Bc,Zl=qc,Xl=zc,ed=Hc,td=Kc,rd=Yc,nd=$c,ad=Jc,od=Qc,id=Zc,ud=Xc,cd=es,sd=ts,fd=rs;function pd(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyTranslations);case 2:if(t=e.sent){e.next=9;break}return e.next=6,be(vp);case 6:return e.next=8,Ae(Ac.getPropertyTranslations);case 8:t=e.sent;case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}},dl,this)}function ld(t){var r,n,a,o,i,u,c,s,f,p,l,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return p=function(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(function(e){return e.type===Bt.getActionName()&&Xp("payload.customId",e)===a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},r,this)},r=regeneratorRuntime.mark(p),e.next=4,be(cs,Ac.getPropertyChatState);case 4:return a=(n=t.payload).customId,o=n.text,i=e.sent!==xp,e.next=9,Ae(Ac.getPropertyWelcomeMessage);case 9:return u=e.sent,e.next=12,be(pd);case 12:return c=e.sent,e.next=15,Ae(Tc);case 15:if(e.t0=e.sent.name,e.t0){e.next=18;break}e.t0=c.client;case 18:return s=e.t0,u||(u=c.welcome_to_chat),e.next=22,Ae(Ac.getPropertyAcceptedInvitation);case 22:return f=e.sent,e.next=25,_e(p);case 25:if(l=e.sent,e.prev=26,!i){e.next=32;break}return e.next=30,be(wp,{customId:a,text:o,welcomeMessage:u.replace(/%name%/,s),acceptedInvitation:f});case 30:e.next=34;break;case 32:return e.next=34,be(kp,{customId:a,text:o});case 34:e.next=42;break;case 36:return e.prev=36,e.t1=e.catch(26),t.payload.promise.reject({type:"connection",reason:"Request failed"}),e.next=41,ke(l);case 41:return e.abrupt("return");case 42:if(!i){e.next=49;break}return e.next=45,me([Vt.getActionName(),qt.getActionName()]);case 45:if(e.sent.type!==qt.getActionName()){e.next=49;break}return t.payload.promise.reject({type:"state",reason:"Chat is offline"}),e.abrupt("return");case 49:return e.next=51,Ie(l);case 51:t.payload.promise.resolve({id:(d=e.sent).payload.id,timestamp:d.payload.timestamp});case 53:case"end":return e.stop()}},vl,this,[[26,36]])}function dd(t){var r,n,a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyClientLimitExceeded);case 2:return e.next=4,Ae(Tc);case 4:return r=e.sent,n=ul(tl,ll(["name","email","pageUrl","pageTitle","customProperties"],t.payload)),a=Math.random()+"",o=sl(r,n),e.next=10,he(Qt({requestId:a,visitorData:o}));case 10:return e.next=12,me(function(e){return(e.type===zt.getActionName()||e.type===Ht.getActionName())&&e.payload.requestId===a});case 12:if((i=e.sent).type!==zt.getActionName()){e.next=15;break}return e.abrupt("return",t.payload.promise.resolve(i.payload.visitorData));case 15:return e.abrupt("return",t.payload.promise.reject({type:"connection",reason:"Request failed"}));case 16:case"end":return e.stop()}},ml,this)}function vd(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(Wt.setPropertySneakPeek(t.payload.text));case 2:t.payload.promise.resolve({success:!0});case 3:case"end":return e.stop()}},hl,this)}function md(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyChatId);case 2:if(e.sent){e.next=6;break}return t.payload.promise.reject({type:"state",reason:"There is no chat to forward transcript"}),e.abrupt("return");case 6:return e.prev=6,e.next=9,be(Tp,t);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(6),t.payload.promise.reject({type:"connection",reason:"Request failed"}),e.abrupt("return");case 15:t.payload.promise.resolve({success:!0});case 16:case"end":return e.stop()}},gl,this,[[6,11]])}function hd(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyChatId);case 2:if(e.sent){e.next=6;break}return t.payload.promise.reject({type:"state",reason:"There is no chat to close"}),e.abrupt("return");case 6:return e.prev=6,e.next=9,be(Ep);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(6),t.payload.promise.reject({type:"connection",reason:"Request failed"}),e.abrupt("return");case 15:return e.next=17,me(qt.getActionName());case 17:t.payload.promise.resolve({success:!0});case 18:case"end":return e.stop()}},yl,this,[[6,11]])}function gd(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyChatId);case 2:if(e.sent){e.next=6;break}return t.payload.promise.reject({type:"state",reason:"There is no chat to rate"}),e.abrupt("return");case 6:if(!t.payload.rate){e.next=16;break}return e.prev=7,e.next=10,be(Sp,t);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(7),t.payload.promise.reject({type:"connection",reason:"Request failed"}),e.abrupt("return");case 16:if(!t.payload.comment){e.next=26;break}return e.prev=17,e.next=20,be(Np,t);case 20:e.next=26;break;case 22:return e.prev=22,e.t1=e.catch(17),t.payload.promise.reject({type:"connection",reason:"Rate Comment request failed"}),e.abrupt("return");case 26:t.payload.promise.resolve({success:!0});case 27:case"end":return e.stop()}},xl,this,[[7,12],[17,22]])}function yd(e){var t=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyChatState);case 2:if(e.sent!==xp){e.next=6;break}return t.promise.reject({type:"state",reason:"You can't disconnect during the chat"}),e.abrupt("return");case 6:t.promise.resolve({success:!0});case 7:case"end":return e.stop()}},bl,this)}function xd(e){var t,r,n,a,o=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.promise,void 0===(r=o.group)){e.next=14;break}return e.prev=2,e.next=5,be(Cp,r);case 5:n=Gf(e.sent.join("^")),t.resolve(cf(uf(n.data.json))),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),t.reject({type:"connection",reason:"Request failed"});case 13:return e.abrupt("return");case 14:return e.next=16,Ae(Ac.getPropertyTicketForm);case 16:if(a=e.sent){e.next=30;break}return e.prev=18,e.next=21,be(dp);case 21:return e.next=23,Ae(Ac.getPropertyTicketForm);case 23:a=e.sent,e.next=30;break;case 26:return e.prev=26,e.t1=e.catch(18),t.reject({type:"connection",reason:"Request failed"}),e.abrupt("return");case 30:t.resolve(a);case 31:case"end":return e.stop()}},_l,this,[[2,10],[18,26]])}function bd(e){var t=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be(pd);case 3:return e.abrupt("return",t.promise.resolve(e.sent));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 10:case"end":return e.stop()}},wl,this,[[0,7]])}function _d(e){var t=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:return e.next=4,Ae(Tc);case 4:return e.abrupt("return",t.promise.resolve(e.sent));case 6:case"end":return e.stop()}},Il,this)}function wd(e){var t=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyTicketForm);case 2:if(e.sent){e.next=5;break}return e.next=5,be(dp);case 5:return e.prev=5,e.t0=t.promise,e.next=9,be(Fp,t);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),t.promise.reject(e.t2.reason?e.t2:{type:"connection",reason:"Request failed"});case 16:case"end":return e.stop()}},kl,this,[[5,13]])}function Id(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyPreChatForm);case 2:return t=e.sent,e.next=5,Ae(Tc);case 5:if(r=e.sent,t){e.next=12;break}return e.next=9,be(dp);case 9:return e.next=11,Ae(Ac.getPropertyPreChatForm);case 11:t=e.sent;case 12:if(t){e.next=14;break}return e.abrupt("return",null);case 14:return(r.name||r.email)&&(n=t.fields.map(function(e){return"name"===e.type&&r.name&&(e.defaultValue=r.name),"email"===e.type&&r.email&&(e.defaultValue=r.email),e}),t.fields=n),e.abrupt("return",t);case 16:case"end":return e.stop()}},Al,this)}function kd(e){var t,r=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be(Id);case 3:if(t=e.sent){e.next=6;break}return e.abrupt("return",r.promise.reject({type:"state",reason:"Pre-chat survey is turned off"}));case 6:return e.abrupt("return",r.promise.resolve(t));case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",r.promise.reject({type:"connection",reason:"Request failed"}));case 12:case"end":return e.stop()}},El,this,[[0,9]])}var Ad=["email","text","radio","select","group_select"],Ed=["checkbox"],Rd=function(e,n){return e.map(function(e){var t=n[e.name],r=vt(n[e.name]);return e.required&&!t?{reason:"Required field",description:"Pease fill in required field",field:e.name}:t&&-1!==Ad.indexOf(e.type)&&"string"!==r?{reason:"Wrong type",field:e.name}:!(!t||-1===Ed.indexOf(e.type)||Array.isArray(t))&&{reason:"Wrong type",field:e.name}}).filter(Boolean)};function Td(e){var t,r,n,a,o,i,u,c,s,f,p,l,d,v,m,h=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyChatState);case 2:if(t=e.sent,e.prev=3,t!==xp){e.next=6;break}return e.abrupt("return",h.promise.reject({type:"state",reason:"You can't send prechat when chat is running"}));case 6:return e.next=8,Ae(Tc);case 8:return r=e.sent,e.next=11,be(Id);case 11:return n=e.sent,a=h.answers,o=h.promise,e.next=15,Ae(Ac.getPropertyAcceptedInvitation);case 15:return i=e.sent,u=sf(a,n),c=Rd(n.fields,a),e.next=20,be(pd);case 20:return s=e.sent,e.next=23,Ae(Ac.getPropertyWelcomeMessage);case 23:if((f=e.sent)||(f=s.welcome_to_chat),0===c.length){e.next=27;break}return e.abrupt("return",h.promise.reject({type:"wrong arguments",fields:c}));case 27:if(!(p=u.fields.filter(function(e){return"email"===e.type||"name"===e.type}))){e.next=32;break}return l=p.reduce(function(e,t){var r;return yt({},e,((r={})[t.type]=t.answer,r))},r),e.next=32,he(Qt({visitorData:l}));case 32:return e.next=34,Ae(Tc);case 34:if(e.t0=e.sent.name,e.t0){e.next=37;break}e.t0=s.client;case 37:return d=e.t0,e.next=40,be(wp,{customId:"prechat_startchat",answers:u,welcomeMessage:f.replace(/%name%/,d),acceptedInvitation:i});case 40:return e.next=42,me(Vt.getActionName());case 42:return v=e.sent,e.next=45,be(cs,Ac.getPropertyChatId);case 45:return m=e.sent,e.next=48,he(Bt({id:"welcome_message",timestamp:Date.now(),authorType:"agent",authorId:v.payload.id,text:f,chatId:m,customId:"welcome_message"}));case 48:return e.abrupt("return",o.resolve({success:!0}));case 51:return e.prev=51,e.t1=e.catch(3),e.abrupt("return",h.promise.reject({type:"connection",reason:"Request failed"}));case 54:case"end":return e.stop()}},Rl,this,[[3,51]])}function Pd(e){var t,r,n,a,o,i,u,c,s,f=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyChatState);case 2:return t=e.sent,e.next=5,Ae(Ec);case 5:return r=e.sent,e.next=8,Ae(Ac.getPropertyLicense);case 8:return n=e.sent,e.next=11,Ae(Ac.getPropertyRegion);case 11:if(a=e.sent,o=f.customId,i=f.file,u=f.onProgress,e.prev=13,t===xp){e.next=17;break}return e.next=17,be(wp,{customId:o+"_startchat",text:""});case 17:return e.next=19,be(cs,Ac.getPropertyChatId);case 19:return c=e.sent,e.next=22,be(Wp,f);case 22:return s=e.sent.attachment_token,e.next=26,be(bf,{environment:r,region:a,license:n,token:s,file:i,chatId:c,onProgress:u});case 26:return e.next=28,me(function(e){return e.type===Kt.getActionName()&&e.payload.attachmentToken===s});case 28:return e.abrupt("return",f.promise.resolve(ul(tl,ll(["id","timestamp","url","contentType","size","width","height"],e.sent.payload))));case 32:return e.prev=32,e.t0=e.catch(13),e.abrupt("return",f.promise.reject({type:"connection",reason:"Request failed"}));case 35:case"end":return e.stop()}},Tl,this,[[13,32]])}function Sd(e){var t,r,n,a,o,i,u,c,s=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be(Hp);case 3:if((t=e.sent).agent){e.next=6;break}return e.abrupt("return",s.promise.resolve({}));case 6:return e.next=8,be(pd);case 8:return n=(r=t.agent).avatar_url,a=r.job_title,o=r.login,i=r.name,u=e.sent.welcome_to_chat,e.next=13,he(Wt.setPropertyWelcomeMessage(u));case 13:return c={name:i,id:o,avatarUrl:Js(n),jobTitle:a,message:u},e.abrupt("return",s.promise.resolve(c));case 17:return e.prev=17,e.t0=e.catch(0),e.abrupt("return",s.promise.reject({type:"connection",reason:"Request failed"}));case 20:case"end":return e.stop()}},Pl,this,[[0,17]])}function Od(e){var t,r,n=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be(Bp);case 3:if((t=Df(e.sent[1])).survey){e.next=7;break}return e.abrupt("return",n.promise.reject({type:"state",reason:"Post-chat survey is turned off"}));case 7:return r=uf(t.survey),e.next=10,he(Wt.setPropertyPostChatForm(r));case 10:return e.abrupt("return",n.promise.resolve(r));case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",n.promise.reject({type:"connection",reason:"Request failed"}));case 16:case"end":return e.stop()}},Sl,this,[[0,13]])}function Cd(e){var t,r,n=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=n.answers,e.next=4,Ae(Ac.getPropertyPostChatForm);case 4:return r=sf(t,e.sent),e.next=8,be(Vp,{answers:r});case 8:return e.abrupt("return",n.promise.resolve({success:!0}));case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",n.promise.reject({type:"connection",reason:"Request failed"}));case 14:case"end":return e.stop()}},Ol,this,[[0,11]])}function jd(e){var t=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyConfig);case 2:if(e.sent){e.next=6;break}return e.next=6,be(dp);case 6:return e.next=8,Ae(Ac.getPropertyConfig);case 8:t.promise.resolve(e.sent);case 10:case"end":return e.stop()}},Cl,this)}function Nd(e){var t=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(Wt.setPropertyAcceptedInvitation(t.id));case 2:t.promise.resolve({success:!0});case 3:case"end":return e.stop()}},jl,this)}function Md(e){var t,r=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=r.messageId,e.next=4,be(Yp,{messageId:t});case 4:return e.abrupt("return",r.promise.resolve({success:!0}));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",r.promise.reject({type:"connection",reason:"Request failed"}));case 10:case"end":return e.stop()}},Nl,this,[[0,7]])}function Ld(e){var t,r,n=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyChatState);case 2:if(!(e.sent===xp)){e.next=7;break}return n.promise.reject({type:"state",reason:"You can't start new chat during chat"}),e.abrupt("return");case 7:return e.next=9,Ae(Ac.getPropertyWelcomeMessage);case 9:return t=e.sent,e.next=12,be(pd);case 12:return r=e.sent,t||(t=r.welcome_to_chat),e.prev=14,e.next=17,be(wp,{customId:"startchat",welcomeMessage:t});case 17:return e.next=19,be(cs,Ac.getPropertyChatId);case 19:n.promise.resolve({chatId:e.sent}),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(14),n.promise.reject({type:"connection",reason:"Request failed"});case 26:case"end":return e.stop()}},Ml,this,[[14,23]])}function Dd(e){var t,r,n,a,o,i,u,c,s=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.promise,void 0===(t=s.group)){e.next=5;break}e.t0=t,e.next=8;break;case 5:return e.next=7,Ae(Ac.getPropertyGroup);case 7:e.t0=e.sent;case 8:return n=e.t0,e.next=11,Ae(Ac.getPropertyClientLimitExceeded);case 11:if((a=e.sent)||void 0!==t){e.next=22;break}return e.next=15,Ae(Ac.getPropertyChatState);case 15:return o=e.sent===xp,e.next=19,Ae(Ac.getPropertyChatStatus);case 19:return r.resolve({groupStatus:e.sent.toLowerCase(),chatting:o}),e.abrupt("return");case 22:return e.prev=22,e.next=25,be(Jp,n);case 25:if(i=Qp(e.sent),u=i.chatStatus,c=i.chatState,!a||c!==xp){e.next=30;break}return he(Wt.setPropertyClientLimitExceeded(!(e.next=30)));case 30:r.resolve({groupStatus:u.toLowerCase(),chatting:c===xp}),e.next=36;break;case 33:e.prev=33,e.t1=e.catch(22),r.reject({type:"connection",reason:"Request failed"});case 36:case"end":return e.stop()}},Ll,this,[[22,33]])}function Fd(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,be(l,Gl);case 3:return e.next=5,Ae(Ac.getPropertyChatState);case 5:if(e.sent===xp){e.next=10;break}return e.next=10,he(Wt.setPropertyClientLimitExceeded(!0));case 10:e.next=0;break;case 12:case"end":return e.stop()}},Dl,this)}function Ud(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee([ql.getActionName()],ee.expanding());case 2:return t=e.sent,e.next=5,me("VISITOR_DATA_WATCHER");case 5:return e.next=8,me(t);case 8:return r=e.sent,e.next=11,be(cs,Ac.getPropertyPingSent);case 11:return e.next=13,be(dd,r);case 13:e.next=5;break;case 15:case"end":return e.stop()}},Fl,this)}function Wd(e){var t=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,he(Wt.setPropertyGroup(t.group));case 2:case"end":return e.stop()}},Ul,this)}function Gd(){var n,t,r,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e(Fd);case 2:return e.next=4,_e(Ud);case 4:return e.next=6,Te(id.getActionName(),Nd);case 6:return e.next=8,Te(td.getActionName(),bd);case 8:return e.next=10,Te(Jl.getActionName(),xd);case 10:return e.next=12,Te(Ql.getActionName(),wd);case 12:return e.next=14,Te(zl.getActionName(),gd);case 14:return e.next=16,Te(Hl.getActionName(),vd);case 16:return e.next=18,Te(Yl.getActionName(),hd);case 18:return e.next=20,Te(Kl.getActionName(),md);case 20:return e.next=22,Te($l.getActionName(),yd);case 22:return e.next=24,Te(Vl.getActionName(),_d);case 24:return e.next=26,Te(Xl.getActionName(),kd);case 26:return e.next=28,Te(rd.getActionName(),Sd);case 28:return e.next=30,Te(nd.getActionName(),Od);case 30:return e.next=32,Te(ad.getActionName(),Cd);case 32:return e.next=34,Te(od.getActionName(),jd);case 34:return e.next=36,Te(ud.getActionName(),Md);case 36:return e.next=38,Te(sd.getActionName(),Dd);case 38:return e.next=40,Te(fd.getActionName(),Wd);case 40:return e.next=42,Ee([Bl.getActionName(),Zl.getActionName(),ed.getActionName(),cd.getActionName()],ee.expanding());case 42:n=e.sent,t=regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,me(n);case 2:e.t0=(t=e.sent).type,e.next=e.t0===Bl.getActionName()?6:e.t0===Zl.getActionName()?9:e.t0===ed.getActionName()?19:e.t0===cd.getActionName()?22:25;break;case 6:return e.next=8,be(ld,t);case 8:return e.abrupt("break",26);case 9:return e.next=11,_e(Pd,t);case 11:return r=e.sent,e.next=14,ye({success:Ie(r),cancel:me(function(e){return e.type===Vc.getActionName()&&e.payload.customId===t.payload.customId})});case 14:if(!e.sent.cancel){e.next=18;break}return e.next=18,ke(r);case 18:return e.abrupt("break",26);case 19:return e.next=21,be(Td,t);case 21:return e.abrupt("break",26);case 22:return e.next=24,be(Ld,t);case 24:return e.abrupt("break",26);case 25:return e.abrupt("return",{v:void 0});case 26:case"end":return e.stop()}},e,a)});case 44:return e.delegateYield(t(),"t0",46);case 46:if("object"!==(void 0===(r=e.t0)?"undefined":vt(r))){e.next=49;break}return e.abrupt("return",r.v);case 49:e.next=44;break;case 51:case"end":return e.stop()}},Wl,this)}var Bd=regeneratorRuntime.mark(Yd),qd=regeneratorRuntime.mark($d),Vd=regeneratorRuntime.mark(Jd),zd=regeneratorRuntime.mark(Qd),Hd=regeneratorRuntime.mark(Zd),Kd=function(e,t,r,n){var a,o={visitor:{id:t,group:r}};return e&&(o.page={title:n.pageTitle,url:n.pageUrl}),e&&n.pageReferrer&&(o.page.referrer=n.pageReferrer),e&&n.email&&(o.visitor.email=n.email),e&&n.name&&(o.visitor.name=n.name),e&&n.customProperties&&(o.visitor.custom_variables=Object.keys(a=n.customProperties).map(function(e){return{name:e+"",value:a[e]+""}})),o};function Yd(e){var t,r,n,a,o,i,u,c,s,f=e.sendFullPing;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:return t=e.sent,e.next=5,Ae(Ac.getPropertyLicense);case 5:return r=e.sent,e.next=8,Ae(Ac.getPropertyGroup);case 8:return n=e.sent,e.next=11,Ae(Tc);case 11:return a=e.sent,e.next=14,Ae(Ec);case 14:return o=e.sent,e.next=17,Ae(Ac.getPropertyRegion);case 17:return i=e.sent,u=Kd(f,t,n,a),e.next=21,Ae(Ac.getPropertyChatBetweenGroups);case 21:return c=e.sent,e.prev=22,e.t0=be,e.t1=Af,e.t2=r,e.t3=o,e.t4=i,e.t5=u,e.next=31,Re("external");case 31:return e.t6=e.sent,e.t7=c,e.t8=n,e.t9={license:e.t2,environment:e.t3,region:e.t4,body:e.t5,external:e.t6,chatBetweenGroups:e.t7,group:e.t8},e.t10={retry:10},e.next=38,(0,e.t0)(e.t1,"ping",e.t9,e.t10);case 38:return s=e.sent,e.next=41,Ae(Ac.getPropertyConnectionStatus);case 41:if("connected"===e.sent){e.next=45;break}return e.next=45,he(Wt.setPropertyConnectionStatus("connected"));case 45:return e.abrupt("return",s);case 48:return e.prev=48,e.t11=e.catch(22),e.next=52,Ae(Ac.getPropertyConnectionStatus);case 52:if("disconnected"===e.sent){e.next=56;break}return e.next=56,he(Wt.setPropertyConnectionStatus("disconnected"));case 56:return e.abrupt("return",{error:!0});case 57:case"end":return e.stop()}},Bd,this,[[22,48]])}function $d(t){var r,n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.automatic_greeting){e.next=8;break}return r=Qs(t.automatic_greeting),n=r.agent,a=r.invitation,e.next=4,he(Vt(n));case 4:return e.next=6,he(tr(a));case 6:e.next=20;break;case 8:if(!t.personal_greeting){e.next=13;break}return e.next=11,be(wp,{customId:Math.random+"",welcomeMessage:t.personal_greeting.greeting_message.message,fromManualInvitation:!0});case 11:e.next=20;break;case 13:if(!t.standard_greeting){e.next=20;break}return e.next=16,be(pd);case 16:return o=e.sent.welcome_to_chat,e.next=20,be(wp,{customId:Math.random+"",welcomeMessage:o,fromManualInvitation:!0});case 20:case"end":return e.stop()}},qd,this)}function Jd(){var t,r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee(Qt.getActionName(),ee.expanding());case 2:return t=e.sent,e.next=5,he({type:"VISITOR_DATA_WATCHER"});case 5:return e.next=8,me(t);case 8:return r=e.sent,e.next=11,be(Yd,{sendFullPing:!0});case 11:if(!(n=e.sent).error){e.next=16;break}return e.next=15,he(Ht({error:n.error,requestId:r.payload.requestId}));case 15:return e.abrupt("return",e.sent);case 16:return e.next=18,be($d,n);case 18:return e.next=20,Ae(Tc);case 20:return a=e.sent,e.next=23,he(zt({visitorData:a,requestId:r.payload.requestId}));case 23:e.next=5;break;case 25:case"end":return e.stop()}},Vd,this)}function Qd(){var t,r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=3,r=!0,e.next=4,be(cs,Ac.getPropertyConfigLoaded);case 4:return e.next=7,be(Yd,{sendFullPing:r});case 7:if(a=r,r=!!(n=e.sent).next_ping_send_full_details,0!==n.next_ping_delay){e.next=16;break}return e.next=13,be(gp);case 13:return e.next=15,he(Wt.setPropertyClientLimitExceeded(!0));case 15:return e.abrupt("return");case 16:return t=!a&&r?0:n.next_ping_delay||3,e.next=19,be($d,n);case 19:return e.next=21,he(Wt.setPropertyPingSent(!0));case 21:return e.next=23,be(l,1e3*t);case 23:e.next=4;break;case 25:case"end":return e.stop()}},zd,this)}function Zd(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e(Qd);case 2:return e.next=4,_e(Jd);case 4:case"end":return e.stop()}},Hd,this)}var Xd=Math.max;var ev=Qu("find",function(i){return function(e,t,r){var n=Object(e);if(!Ba(e)){var a=Uu(t,3);e=qa(e),t=function(e){return a(n[e],e,n)}}var o=i(e,t,r);return-1<o?n[a?e[o]:o]:void 0}}(function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var a=null==r?0:fa(r);return a<0&&(a=Xd(n+a,0)),Tn(e,Uu(t,3),a)}));ev.placeholder=ir;var tv=ev,rv=function(r){var e=GLOBAL.cookie.split(";"),t=tv(function(e){var t=Hs(e).split("=");return decodeURIComponent(t[0])===r},e);return t?decodeURIComponent(t.split("=")[1]):null},nv=regeneratorRuntime.mark(av);function av(){var t,r,n,a,o,i,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyConfigLoaded);case 2:return e.next=5,Ae(Ac.getPropertyLicense);case 5:return t=e.sent,e.prev=6,e.next=9,be(Jp);case 9:return r=e.sent,e.next=12,Ae(Ac.getPropertyChatStatus);case 12:return n=e.sent,e.next=15,Ae(Ac.getPropertyChatState);case 15:return a=e.sent,o=Qp(r),i=o.chatStatus,u=o.chatState,e.next=19,Ae(Ac.getPropertyConnectionStatus);case 19:if("connected"===e.sent){e.next=23;break}return e.next=23,he(Wt.setPropertyConnectionStatus("connected"));case 23:if(n===i){e.next=26;break}return e.next=26,he(Wt.setPropertyChatStatus(i));case 26:if(a===u||u!==xp){e.next=32;break}return c=vs.getItem("securedToken")||rv("secret_token_"+t),e.next=30,he(Wt.setPropertySecuredToken(c));case 30:return e.next=32,he(Wt.setPropertyChatState(u));case 32:e.next=42;break;case 34:return e.prev=34,e.t0=e.catch(6),e.next=38,Ae(Ac.getPropertyConnectionStatus);case 38:if("disconnected"===e.sent){e.next=42;break}return e.next=42,he(Wt.setPropertyConnectionStatus("disconnected"));case 42:return e.next=44,be(l,3e3);case 44:e.next=2;break;case 46:case"end":return e.stop()}},nv,this,[[6,34]])}var ov="chat_started",iv="new_message",uv="chat_ended",cv="agent_changed",sv="status_changed",fv="connection_status_changed",pv="new_file",lv="visitor_queued",dv="typing_indicator",vv="visitor_data",mv="chat_rated",hv="new_invitation",gv="ready",yv="message_seen",xv="protocol_upgraded",bv=regeneratorRuntime.mark(Pv),_v=regeneratorRuntime.mark(Cv),wv=regeneratorRuntime.mark(jv),Iv=regeneratorRuntime.mark(Nv),kv=regeneratorRuntime.mark(Dv),Av=regeneratorRuntime.mark(Uv),Ev=regeneratorRuntime.mark(Bv),Rv=regeneratorRuntime.mark(qv),Tv=regeneratorRuntime.mark(Vv);function Pv(e,t){var r,n,a,o=e.emitter,i=t.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyChatId);case 2:if(o.emit(ov,{chatId:r=e.sent}),!i.welcomeMessage){e.next=15;break}return e.next=7,Ae(Ac.getPropertyLastAgentId);case 7:return n=e.sent,e.next=10,Ae(Ac.getPropertyServerIdsMap);case 10:return a=e.sent,e.next=13,he(Wt.setPropertyServerIdsMap(yt({},a,{welcome_message:{serverId:"welcome_message",authorId:n}})));case 13:return e.next=15,he(Bt({id:"welcome_message",timestamp:Date.now(),authorType:"agent",authorId:n,text:i.welcomeMessage,chatId:r,customId:"welcome_message"}));case 15:if(!i.visitorMessage){e.next=18;break}return e.next=18,he(Bt(i.visitorMessage));case 18:return e.next=20,me(qt.getActionName());case 20:return o.emit(uv),e.next=23,he(Wt.setPropertyLastMessageId(null));case 23:case"end":return e.stop()}},bv,this)}function Sv(e,t){e.emitter.emit(sv,{status:t.payload.data.toLowerCase()})}function Ov(e,t){e.emitter.emit(fv,{status:t.payload.data.toLowerCase()})}function Cv(e,t){var r,n,a,o=e.emitter,i=t.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyChatId);case 2:return r=e.sent,e.next=5,Ae(Ac.getPropertyVisitorId);case 5:n=e.sent,a={id:i.id,timestamp:i.timestamp,authorId:"visitor"===i.authorType?n:i.authorId,text:i.text,chatId:r},void 0!==i.isMobile&&(a.isMobile=i.isMobile),void 0!==i.customId&&(a.customId=i.customId),o.emit(iv,a);case 10:case"end":return e.stop()}},_v,this)}function jv(e,t){var r,n,a=e.emitter,o=t.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyVisitorId);case 2:r=e.sent,n={id:o.id,timestamp:o.timestamp,authorId:"visitor"===o.authorType?r:o.authorId,url:o.url,contentType:o.contentType,size:o.size},o.thumbnail&&(n.thumbnail=o.thumbnail),a.emit(pv,n);case 6:case"end":return e.stop()}},wv,this)}function Nv(e,t){var r,n=e.emitter,a=t.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Ae(Ac.getPropertyLastAgentId)!==a.id){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,he(Wt.setPropertyLastAgentId(a.id));case 5:r={name:a.name,id:a.id},a.avatarUrl&&(r.avatarUrl=a.avatarUrl),a.jobTitle&&(r.jobTitle=a.jobTitle),n.emit(cv,r);case 9:case"end":return e.stop()}},Iv,this)}function Mv(e,t){var r=t.payload;e.emitter.emit(lv,{numberInQueue:r.numberInQueue,waitingTime:r.waitingTime})}function Lv(e,t){var r=t.payload;e.emitter.emit(dv,{authorId:r.authorId,isTyping:r.isTyping})}function Dv(e){var t,r=e.emitter;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:t=e.sent,Promise.resolve().then(function(){r.emit(vv,{id:t})});case 4:case"end":return e.stop()}},kv,this)}function Fv(e,t){e.emitter.emit(mv,{rate:t.payload.rate,comment:t.payload.comment})}function Uv(e,t){var r=e.emitter;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.emit(hv,t.payload),e.next=3,me(function(e){return e.type===Zc.getActionName()&&e.payload.id===t.payload.id});case 3:return e.next=5,he(Wt.setPropertyWelcomeMessage(t.payload.text));case 5:case"end":return e.stop()}},Av,this)}function Wv(e){e.emitter.emit(gv)}function Gv(e,t){e.emitter.emit(yv,t.payload)}function Bv(t,r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,be(t[n.type],{emitter:r},n);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}},Ev,this,[[0,5]])}function qv(e){var t=e.emitter;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.emit(xv);case 1:case"end":return e.stop()}},Rv,this)}function Vv(e){var t,r,n=e.emitter;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e(Dv,{emitter:n});case 2:return(t={})[Gt.getActionName()]=Pv,t[Wt.setPropertyChatStatus.getActionName()]=Sv,t[Wt.setPropertyConnectionStatus.getActionName()]=Ov,t[Bt.getActionName()]=Cv,t[Kt.getActionName()]=jv,t[Vt.getActionName()]=Nv,t[Yt.getActionName()]=Mv,t[$t.getActionName()]=Lv,t[Jt.getActionName()]=Fv,t[tr.getActionName()]=Uv,t[Wt.setPropertyHistoryLoaded.getActionName()]=Wv,t[rr.getActionName()]=Gv,t[nr.getActionName()]=qv,r=t,e.next=5,Te(Object.keys(r),Bv,r,n);case 5:case"end":return e.stop()}},Tv,this)}var zv=Lt("INCOMING_MESSAGE",function(e){return{name:e.name,message:e.message}});var Hv=Qu("mapKeys",function(e,n){var a={};return n=Uu(n,3),Xu(e,function(e,t,r){va(a,n(e,t,r),e)}),a});Hv.placeholder=ir;var Kv=Hv;var Yv=function(a){return function(e){e=Ru(e);var t=bs(e)?Ds(e):void 0,r=t?t[0]:e.charAt(0),n=t?ys(t,1).join(""):e.slice(1);return r[a]()+n}}("toUpperCase");var $v=function(e){return Yv(Ru(e).toLowerCase())};var Jv=function(e,t,r,n){var a=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++a]);++a<o;)r=t(r,e[a],a,e);return r};var Qv=function(t){return function(e){return null==t?void 0:t[e]}}({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),Zv=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Xv=/[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]/g;var em=function(e){return(e=Ru(e))&&e.replace(Zv,Qv).replace(Xv,"")},tm=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var rm=function(e){return e.match(tm)||[]},nm=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var am=function(e){return nm.test(e)},om="\\ud800-\\udfff",im="\\u2700-\\u27bf",um="a-z\\xdf-\\xf6\\xf8-\\xff",cm="A-Z\\xc0-\\xd6\\xd8-\\xde",sm="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",fm="["+sm+"]",pm="\\d+",lm="["+im+"]",dm="["+um+"]",vm="[^"+om+sm+pm+im+um+cm+"]",mm="(?:\\ud83c[\\udde6-\\uddff]){2}",hm="[\\ud800-\\udbff][\\udc00-\\udfff]",gm="["+cm+"]",ym="(?:"+dm+"|"+vm+")",xm="(?:"+gm+"|"+vm+")",bm="(?:['](?:d|ll|m|re|s|t|ve))?",_m="(?:['](?:D|LL|M|RE|S|T|VE))?",wm="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Im="[\\ufe0e\\ufe0f]?",km=Im+wm+("(?:\\u200d(?:"+["[^"+om+"]",mm,hm].join("|")+")"+Im+wm+")*"),Am="(?:"+[lm,mm,hm].join("|")+")"+km,Em=RegExp([gm+"?"+dm+"+"+bm+"(?="+[fm,gm,"$"].join("|")+")",xm+"+"+_m+"(?="+[fm,gm+ym,"$"].join("|")+")",gm+"?"+ym+"+"+bm,gm+"+"+_m,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])|\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",pm,Am].join("|"),"g");var Rm=function(e){return e.match(Em)||[]};var Tm=function(e,t,r){return e=Ru(e),void 0===(t=r?void 0:t)?am(e)?Rm(e):rm(e):e.match(t)||[]},Pm=/[']/g;var Sm=Qu("camelCase",function(t){return function(e){return Jv(Tm(em(e).replace(Pm,"")),t,"")}}(function(e,t,r){return t=t.toLowerCase(),e+(r?$v(t):t)}),oc);Sm.placeholder=ir;var Om=Sm,Cm=1800,jm=regeneratorRuntime.mark(Nm);function Nm(){var t,r,n,a,o,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyVisitorId);case 2:return t=e.sent,e.next=5,Ae(Ac.getPropertyGroup);case 5:return r=e.sent,e.next=8,Ae(Ac.getPropertyLastMessageId);case 8:return n=e.sent,a=i.sneakPeek,o={random_id:Math.random()+"",visitor:{id:t,group:r}},n&&(o.last_unique_id=n),"string"==typeof a&&(o.sneak_peek=a),e.next=15,be($f,"get_pending_messages",o);case 15:return e.abrupt("return",e.sent);case 16:case"end":return e.stop()}},jm,this)}var Mm=regeneratorRuntime.mark(Gm),Lm=regeneratorRuntime.mark(zm),Dm=regeneratorRuntime.mark(Hm),Fm=regeneratorRuntime.mark(Km),Um=regeneratorRuntime.mark(Ym),Wm="";function Gm(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyLicense);case 2:return t=e.sent,e.next=5,he(Wt.setPropertyChatState(bp));case 5:return e.next=7,he(Wt.removePropertySecuredToken());case 7:return e.next=9,he(qt());case 9:return vs.removeItem("securedToken"),vs.removeOldSecretTokenCookie(t),e.next=13,he(Wt.setPropertyServerIdsMap({}));case 13:return e.next=15,he(Wt.setPropertyVisitorCustomIdMap({}));case 15:case"end":return e.stop()}},Mm,this)}var Bm=function(e){return Xp("message.data",e)&&(e.message.data=Kv(Om,e.message.data)),Xp("message.name",e)&&(e.message.name=Om(e.message.name)),yt({timestamp:e.timestamp,uniqueId:e.unique_id},e.message)},qm=function(e){return Math.max.apply(Math,[0].concat(e.map(function(e){return e.unique_id})))},Vm=function(e){return e.messages.map(function(e){if(e.message_iwcs){var t=Gf(e.message_iwcs);return!!t&&{timestamp:e.timestamp,unique_id:e.unique_id,message:t}}return e}).filter(Boolean).map(Bm)};function zm(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyConfigLoaded);case 2:return e.next=4,Ae(Ac.getPropertySecuredToken);case 4:if(!e.sent){e.next=36;break}return e.prev=6,e.next=9,be(Nm);case 9:if(!(t=e.sent).messages){e.next=22;break}return r=Vm(t),e.next=14,ge(r.map(function(e){return he(zv({name:e.name,message:e}))}));case 14:if(!(n=qm(t.messages))){e.next=18;break}return e.next=18,he(Wt.setPropertyLastMessageId(n));case 18:return e.next=20,he(Wt.setPropertyChatState(xp));case 20:e.next=24;break;case 22:return e.next=24,be(Gm);case 24:e.next=34;break;case 26:return e.prev=26,e.t0=e.catch(6),e.next=30,Ae(Ac.getPropertyConnectionStatus);case 30:if("disconnected"===e.sent){e.next=34;break}return e.next=34,he(Wt.setPropertyConnectionStatus("disconnected"));case 34:e.next=38;break;case 36:return e.next=38,he(Wt.setPropertyChatState(bp));case 38:return e.next=40,he(Wt.setPropertyHistoryLoaded(!0));case 40:case"end":return e.stop()}},Lm,this,[[6,26]])}function Hm(){var t,r,n,a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Ae(Ac.getPropertySecuredToken);case 3:return t=e.sent,e.next=6,Ae(Ac.getPropertyChatState);case 6:return r=e.sent,e.next=9,Ae(Ac.getPropertySneakPeek);case 9:if(n=e.sent,!t||r!==xp){e.next=43;break}return e.prev=11,e.next=14,be(Nm,{sneakPeek:Wm!==n?n:null});case 14:return a=e.sent,e.next=17,Ae(Ac.getPropertyConnectionStatus);case 17:if("connected"===e.sent){e.next=21;break}return e.next=21,he(Wt.setPropertyConnectionStatus("connected"));case 21:if(a.messages){e.next=26;break}return e.next=24,be(Gm);case 24:e.next=33;break;case 26:if(o=Vm(a),!(i=qm(a.messages))){e.next=31;break}return e.next=31,he(Wt.setPropertyLastMessageId(i));case 31:return e.next=33,ge(o.map(function(e){return he(zv({name:e.name,message:e}))}));case 33:e.next=43;break;case 35:return e.prev=35,e.t0=e.catch(11),e.next=39,Ae(Ac.getPropertyConnectionStatus);case 39:if("disconnected"===e.sent){e.next=43;break}return e.next=43,he(Wt.setPropertyConnectionStatus("disconnected"));case 43:return Wm=n,e.next=46,ye([be(l,Cm),me(qc.getActionName()),me("PRIVATE_SEND_MESSAGE")]);case 46:e.next=0;break;case 48:case"end":return e.stop()}},Dm,this,[[11,35]])}function Km(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(cs,Ac.getPropertyChatState);case 2:return e.next=4,be(Hm);case 4:return e.next=6,Te(Wt.setPropertyChatState.getActionName(),Hm);case 6:case"end":return e.stop()}},Fm,this)}function Ym(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be(zm);case 2:return e.next=4,we(Km);case 4:case"end":return e.stop()}},Um,this)}var $m="agentMessageSeen",Jm="sendMessage",Qm="startChat",Zm="chatAttachment",Xm="sendRatingComment",eh="visitorMessageSeen",th=Qu("getOr",Ou);th.placeholder=ir;var rh=th,nh=regeneratorRuntime.mark(ih),ah=regeneratorRuntime.mark(uh),oh=regeneratorRuntime.mark(ch);function ih(t,r){var n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyVisitorCustomIdMap);case 2:return a=e.sent,e.next=5,he(Wt.setPropertyVisitorCustomIdMap(yt({},a,((n={})[t]=r,n))));case 5:case"end":return e.stop()}},nh,this)}function uh(e){var t,r,n,a,o,i,u,c,s=e.payload;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(r=s.message).timestamp*=1e3,e.t0=r.name,e.next=e.t0===Qm?5:e.t0===Jm?18:e.t0===Uf.RATE_CHAT?23:e.t0===Xm?26:e.t0===Zm?29:e.t0===Uf.NEW_AGENT_MESSAGE?32:e.t0===Uf.AGENTS_OFFLINE?40:e.t0===Uf.CHAT_ENDED?40:e.t0===Uf.NEW_AGENT?56:e.t0===Uf.VISITOR_QUEUED?65:e.t0===Uf.TYPING_INDICATOR?68:e.t0===eh?71:e.t0===$m?83:95;break;case 5:return e.next=7,Ae(Ac.getPropertySecuredToken);case 7:return e.t1=e.sent,e.t2=r.data.welcomeMessage,n={securedToken:e.t1,welcomeMessage:e.t2},r.data.visitorMessage&&(n.visitorMessage={id:r.uniqueId,timestamp:r.timestamp,authorType:"visitor",text:r.data.visitorMessage,customId:r.data.randomId}),e.next=13,he(Wt.setPropertyChatId(void 0));case 13:return e.next=15,he(Gt(n));case 15:return e.next=17,be(ih,r.data.randomId,r.uniqueId);case 17:return e.abrupt("break",96);case 18:return e.next=20,be(ih,r.data.randomId,r.uniqueId);case 20:return e.next=22,he(Bt({id:r.uniqueId,timestamp:r.timestamp,authorType:"visitor",text:r.data.message,customId:r.data.randomId}));case 22:return e.abrupt("break",96);case 23:return e.next=25,he(Jt({id:r.uniqueId,timestamp:r.timestamp,rate:r.data.rate,comment:r.data.comment}));case 25:return e.abrupt("break",96);case 26:return e.next=28,he(Jt({id:r.uniqueId,timestamp:r.timestamp,comment:r.data.comment}));case 28:return e.abrupt("break",96);case 29:return e.next=31,he(Kt({id:r.uniqueId,timestamp:r.timestamp,authorId:r.data.author.login||"visitor",authorType:r.data.author.type,url:r.data.files[0].url,size:r.data.files[0].size,contentType:r.data.files[0]["content-type"],attachmentToken:r.data.attachmentToken,thumbnail:r.data.files[0].thumbs}));case 31:return e.abrupt("break",96);case 32:return e.next=34,Ae(Ac.getPropertyServerIdsMap);case 34:return a=e.sent,e.next=37,he(Wt.setPropertyServerIdsMap(yt({},a,((t={})[r.uniqueId]={serverId:r.data.id,authorId:r.data.authorId},t))));case 37:return e.next=39,he(Bt({id:r.uniqueId,timestamp:r.timestamp,authorType:"agent",text:r.data.message,isMobile:r.data.isMobile,authorId:r.data.authorId,serverId:r.data.id}));case 39:return e.abrupt("break",96);case 40:return e.next=42,he(qt());case 42:return e.next=44,he(Wt.setPropertyChatState(bp));case 44:return e.next=46,Ae(Ac.getPropertyHistoryLoaded);case 46:return o=e.sent,e.next=49,Ae(Ac.getPropertyLicense);case 49:if(i=e.sent,vs.removeItem("securedToken"),vs.removeOldSecretTokenCookie(i),o){e.next=55;break}return e.next=55,he(Wt.removePropertySecuredToken());case 55:return e.abrupt("break",96);case 56:return e.next=58,he(Vt({id:r.data.id,name:r.data.name,jobTitle:r.data.jobTitle,avatarUrl:Js(r.data.avatarUrl)}));case 58:return e.next=60,Ae(Ac.getPropertyChatId);case 60:if(e.sent){e.next=64;break}return e.next=64,he(Wt.setPropertyChatId(r.data.chatId));case 64:return e.abrupt("break",96);case 65:return e.next=67,he(Yt({numberInQueue:r.data.numberInQueue,waitingTime:r.data.waitingTime}));case 67:return e.abrupt("break",96);case 68:return e.next=70,he($t({authorId:r.data.authorId,isTyping:r.data.isTyping}));case 70:return e.abrupt("break",96);case 71:return e.t3=he,e.t4=ar,e.next=75,Ae(Ac.getPropertyVisitorCustomIdMap);case 75:return e.t5=r.data.id,e.t6=e.sent[e.t5],e.t7=r.data.id,e.t8={id:e.t6,customId:e.t7,type:"visitor"},e.t9=e.t4.messageSeen.call(e.t4,e.t8),e.next=82,(0,e.t3)(e.t9);case 82:return e.abrupt("break",96);case 83:return e.next=85,Ae(Ac.getPropertyServerIdsMap);case 85:if(c=null,u=e.sent){e.next=89;break}return e.abrupt("break",96);case 89:if(Pt(function(e,t){e.serverId===r.data.message.id&&(c=t)},u),c){e.next=92;break}return e.abrupt("break",96);case 92:return e.next=94,he(rr({id:c,customId:r.data.message.id,type:"agent"}));case 94:return e.abrupt("break",96);case 95:return e.abrupt("return");case 96:case"end":return e.stop()}},ah,this)}function ch(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee(zv.getActionName(),ee.expanding());case 2:t=e.sent;case 3:return e.next=6,me(t);case 6:return r=e.sent,e.next=9,be(uh,r);case 9:e.next=3;break;case 11:case"end":return e.stop()}},oh,this)}var sh=regeneratorRuntime.mark(mh),fh=regeneratorRuntime.mark(hh),ph=regeneratorRuntime.mark(gh),lh=[jc,Hc,es,Gt].map(function(e){return e.getActionName()}),dh=function(e){var t=e.payload;return e.type===Wt.setPropertyClientLimitExceeded.getActionName()&&!0===t.data},vh=function(e){var t=e.payload;return e.type===Wt.setPropertyClientLimitExceeded.getActionName()&&!1===t.data};function mh(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ss(_e(Ym));case 2:t=e.sent;case 3:return e.next=6,ye([me(lh),me(vh)]);case 6:return e.next=8,ss(_e(av));case 8:return r=e.sent,e.next=11,ss(_e(Zd));case 11:return n=e.sent,e.next=14,ye([me(Wc.getActionName()),me(dh)]);case 14:return e.next=16,he(Wt.setPropertyPingSent(void 0));case 16:return e.next=18,ke(r,t,n);case 18:e.next=3;break;case 20:case"end":return e.stop()}},sh,this)}function hh(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,me(Wt.setPropertyGroup);case 3:return t=e.sent.payload.data,e.next=7,Ae(Ac.getPropertyLicense);case 7:vs.setPrefix("_livechat_"+e.sent+"_"+t),e.next=0;break;case 11:case"end":return e.stop()}},fh,this)}function gh(e){var t=e.emitter,r=e.serverConfig;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(Ac.getPropertyChatBetweenGroups);case 2:if(!1!==e.sent){e.next=6;break}return e.next=6,ss(_e(hh));case 6:return e.next=8,ss(_e(Gd));case 8:return e.next=10,ss(_e(Vv,{emitter:t}));case 10:return e.next=12,ss(_e(ch));case 12:return e.next=14,ss(_e(mh));case 14:return e.next=16,be(yp,r);case 16:case"end":return e.stop()}},ph,this)}var yh="undefined"!=typeof GLOBAL;var xh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bh=function(){var n,r={},a=(n=(n=r)||Object.create(null),{on:function(e,t){(n[e]||(n[e]=[])).push(t)},off:function(e,t){n[e]&&n[e].splice(n[e].indexOf(t)>>>0,1)},emit:function(t,r){(n[t]||[]).slice().map(function(e){e(r)}),(n["*"]||[]).slice().map(function(e){e(t,r)})}});return xh({},a,{off:function(e,t){e?a.off(e,t):Object.keys(r).forEach(function(e){delete r[e]})},once:function(r,n){a.on(r,function e(t){a.off(r,e),n(t)})}})},_h="LISTENER_IDENTITY",wh={};e.init=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.license,n=t.group,a=t.environment,o=void 0===a?lf:a,i=t.page,u=void 0===i?{}:i,c=t.visitor,s=void 0===c?{}:c,f=t.external,p=void 0===f||f,l=arguments[1];if(!r)throw Error("Missing license parameter");if(o!==lf&&o!==vf&&o!==df)throw Error("Wrong environment parameter");var d=bh(),v=d.emit,m=[];d.emit=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];m.push(t)},setTimeout(function(){d.emit=v,m.forEach(function(e){d.emit.apply(d,e)}),m=null},0);var h=Math.random()+"";vs.setPrefix("_livechat_"+r);var g=((e={environment:o})[Ut.LICENSE]=r,e[Ut.GROUP]=n,e[Ut.SESSION_ID]=h,e.visitorData={email:s.email||null,name:s.name||null,pageUrl:u.url||rh("unknown","location.href"),pageTitle:u.title||rh("unknown","[0].innerHTML",yh),pageReferrer:u.referrer,customProperties:s.customProperties||null},e[Ut.SECURED_TOKEN]=vs.getItem("securedToken")||rv("secret_token_"+r),e[Ut.SECRET_ID]=vs.getItem("secretId"),e[Ut.CHAT_BETWEEN_GROUPS]=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return(!e.__lc||!1!==e.__lc.chat_between_groups)&&-1==="123"}(l),e),y=Cc(g,{external:p}),x=vs.getItem("visitorId");x&&y.dispatch(Wt.setPropertyVisitorId(x));var b,_,w,I,k,A,E,R,T,P,S,O,C,j,N,M,L,D,F,U,W,G,B,q,V=y.runSaga(gh,{emitter:d,serverConfig:l});return{sendMessage:(q=y,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.text,r=e.customId,n=K();return t&&r?q.dispatch(jc({customId:r,text:t,promise:n})):n.reject({type:"missing argument",reason:"Missing text or customId parameter"}),n.promise}),setSneakPeek:(B=y,function(e){var t=e.text,r=K();return B.dispatch(Dc({text:t,promise:r})),r.promise}),setVisitorData:(G=y,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.name,r=e.email,n=e.customProperties,a=e.pageUrl,o=e.pageTitle,i=K();return t||r||n||a||o?G.dispatch(Nc({name:t,email:r,customProperties:n,pageUrl:a,pageTitle:o,promise:i})):i.reject({type:"missing argument",reason:"Missing name, email, url or customProperties"}),i.promise}),getVisitorData:(W=y,function(){var e=K();return W.dispatch(Mc({promise:e})),e.promise}),rateChat:(U=y,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.rate,r=e.comment,n=K();return t||r?t&&"good"!==t&&"none"!==t&&"bad"!==t?n.reject({type:"wrong argument",reason:'Rate argument should be equal "good", "bad" or "none"'}):U.dispatch(Lc({rate:t,comment:r,promise:n})):n.reject({type:"missing argument",reason:"Missing rate parameter"}),n.promise}),forwardChatTranscript:(F=y,function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).email,t=K();return e?F.dispatch(Fc({email:e,promise:t})):t.reject({type:"missing argument",reason:"Missing email parameter"}),t.promise}),closeChat:(D=y,function(){var e=K();return D.dispatch(Uc({promise:e})),e.promise}),disconnect:(L=y,function(){var e=K();return L.dispatch(Wc({promise:e})),e.promise}),getTicketForm:(M=y,function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).group,t=K();return M.dispatch(Gc({promise:t,group:e})),t.promise}),getTranslations:(N=y,function(){var e=K();return N.dispatch(Kc({promise:e})),e.promise}),sendTicketForm:(j=y,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=K();return j.dispatch(Bc({answers:e,promise:t})),t.promise}),sendFile:(C=y,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.file,r=e.onProgress,n=Math.random()+"",a=K();return t?10485760<t.size?(a.reject({type:"wrong argument",reason:"Cannot upload a file over 10MB"}),a.promise):(C.dispatch(qc({file:t,customId:n,promise:a,onProgress:r})),{then:function(e,t){return a.promise.then(e,t)},catch:function(e){return a.promise.catch(e)},cancel:function(){C.dispatch(Vc({customId:n}))}}):(a.reject({type:"missing argument",reason:"Missing file"}),a.promise)}),on:d.on,off:d.off,destroy:(S=V,O=d,function(){O.off("*"),S.cancel()}),getPrechatForm:(P=y,function(){var e=K();return P.dispatch(zc({promise:e})),e.promise}),sendPrechatForm:(T=y,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=K();return T.dispatch(Hc({promise:t,answers:e})),t.promise}),getPredictedAgent:(R=y,function(){var e=K();return R.dispatch(Yc({promise:e})),e.promise}),getPostChatForm:(E=y,function(){var e=K();return E.dispatch($c({promise:e})),e.promise}),sendPostChatForm:(A=y,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=K();return A.dispatch(Jc({promise:t,answers:e})),t.promise}),getConfig:(k=y,function(){var e=K();return k.dispatch(Qc({promise:e})),e.promise}),acceptInvitation:function r(n){return function(e){var t=K();return n.dispatch(Zc({id:e,promise:t})),r.promise}}(y),markMessageAsSeen:(I=y,function(e){var t=K();return I.dispatch(Xc({promise:t,messageId:e})),t.promise}),startChat:(w=y,function(){var e=K();return w.dispatch(es({promise:e})),e.promise}),checkGroupStatus:(_=y,function(e){var t=void 0!==e?parseInt(e,10):void 0,r=K();return _.dispatch(ts({promise:r,group:t})),r.promise}),setVisitorGroup:(b=y,function(e){b.dispatch(rs({group:parseInt(e,10)}))})}},e.debug=function(e){console.warn("You probably do not want to use debug(visitorSDK) in your production environment.");var r=e.on,n=e.off,t=function(e){var u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=Object.keys(e);return n.map(function(o){var i=e[o];return function(){for(var e,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=console).info.apply(e,[u+"."+o+"() ===>"].concat(r));var a=i.apply(void 0,r);return a&&"function"==typeof a.then&&a.then(function(e){console.info(u+"."+o+"() <===",e)}).catch(function(e){console.error(u+"."+o+"() <===",e)}),a}}).reduce(function(e,t,r){return e[n[r]]=t,e},{})}(xt(e,["on","off"]));return Object.freeze(yt({},t,{off:function(e,t){console.info('.off("'+e+'", '+(t.name||"anonymous")+")");var r=t;void 0!==t[_h]&&(r=wh[t[_h][e]]),n(e,r)},on:function(e,t){r(e,function(t,r,n){if(void 0===n[_h]&&Object.defineProperty(n,_h,{value:{}}),n[_h][r])return wh[n[_h][r]];var e=function(e){console.info("."+t+'("'+r+'") <===',e),n(e)},a=St(wh);return wh[n[_h][r]=a]=e}("on",e,t))}}))},e.parseServerConfig=fp,e.getTicketFormRequestBody=Dp,e.translateForm=uf,e.ensureTicketFormRequiredFields=cf,e.sendPostToAPI=_f,Object.defineProperty(e,"__esModule",{value:!0})});
